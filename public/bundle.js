var Reactivity=function(t){var e={};function n(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:o})},n.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/",n(n.s=0)}([function(t,e,n){"use strict";n.r(e);let o=0,i=0;const r=function(t){this.subscribers=[],this.depend=function(t){void 0===this.subscribers.find(e=>e.id===t.id)&&this.subscribers.push(t)},this.notify=function(){this.subscribers.forEach(t=>{console.log(this.name+" notifying "+t.name),t.update()})},this.id=i++,this.name=t};r.target=null;const l=function(t,e,n,...i){this.update=function(){e.apply(n,i)},this.id=o++,this.name=t},p=function(t,e,n,o){console.log("bindPropToTemplate:"+e+":"+this[n]),r.target=new l("Binding prop Watcher: "+e,this.render,this,t,e,o);"function"==typeof this[n]?this[n].apply(this):-1!==n.indexOf(".")?((t,e)=>{let n=e.split(".");console.log(n);let o=t[n[0]];for(let t=1;t<n.length;t++)o=o[n[t]]})(this,n):this[n];r.target=null},a=(t,e,n)=>{e.classList.add(t),setTimeout(()=>{e.classList.remove(t)},n)},c=function(t,e,n){let o=document.getElementById(e);if(o)a("activeProps",o,3e3);else{let i=document.getElementById(n);(o=document.createElement("div")).id=e,o.innerHTML=t.apply(this),i.appendChild(o),a("initProps",o,1e3)}},u=function(t,e,n){if("object"!=typeof t)return t;let o={};for(let i in t){let l=t[i];"object"==typeof t[i]&&(l=u(t[i],e,!0));let p=new r(i);Object.defineProperty(n?o:e,i,{get:function(){return r.target&&p.depend(r.target),l},set:function(t){l=u(t,e),p.notify()}})}return n?o:e},m=function(t,e,n){const o=t.computed,i=t.templates,a=t.props||[],s=t.components||[],d=t.data&&t.data()||{};let f={};return f.render=c,f.bindPropToTemplate=p,f.name=t.name,f.el=t.el,u(d,f),function(t,e){let n={},o={};for(let i in e){let p=null;n[i]=new l("Computed watcher prop: "+i,function(){p=e[i].apply(t),o[i].notify()},null),r.target=n[i],p=e[i].apply(t),r.target=null,o[i]=new r(i),Object.defineProperty(t,i,{get:function(){return r.target&&(o[i].depend(r.target),r.target=null),p}})}}(f,o),function(t,e,n,o){for(let i of e){let e=new r(i);Object.defineProperty(t,i,{get:function(){return r.target&&e.depend(r.target),o[n[i]]}})}}(f,a,e,n),function(t,e){for(let n of e)t.bindPropToTemplate(n.html,n.id,n.prop),t.render(n.html,n.id,t.el)}(f,i),function(t,e){for(let n of e){let e=n.template(),o=n.name,i=n.value;i.templates;if(-1===e.indexOf(o)){console.warn(`${o} not defined in the template`);break}{let n=e.split("</"+o+">")[0].split("data-"),r={};for(let t of n)if(-1!==t.indexOf("=")){let e=t.split("=");r[e[0]]=e[1].split('"')[1]}console.log("propValueHash:"+JSON.stringify(r)),m(i,r,t)}}}(f,s),f};var s={templateForA:function(){return`<p>Hello, I am a <i>data</i> prop. You can call me <strong>A</strong>: ${this.a}</p>`},templateForB:function(){return`<p>Hello, I am a <i>computed</i> prop. You can call me <strong>B</strong> (A * 10): ${this.b}</p>`},templateForC:function(){return`<p>Hello, I am a <i>data</i> prop. You can call me <strong>C</strong>: ${this.c}</p>`},templateForD:function(){return`<p>Hello, I am a <i>computed</i> prop. You can call me <strong>D</strong> (B + 11): ${this.d}</p>`},templateForF:function(){return`<p>Hello, I am a <i>nested data</i> prop. You can call me <strong>F</strong>(Length): ${this.e.f}</p>`},templateForG:function(){return`<p>Hello, I am a <i>nested data</i> prop. You can call me <strong>G</strong>(Width): ${this.e.g}</p>`},templateForH:function(){return`<p>Hello, I am a <i>nested computed</i> prop. You can call me <strong>H</strong>(Area): ${this.nestedComputed}</p>`},templateAForComponentB:function(){return`<p>I'm a child component I have inherited my parent's property a: ${this.a1}</p>`},templateBForComponentB:function(){return`<p>I'm a child component. This is my property B1: ${this.b1}</p>`},templateForChildComponentPlaceholder:function(){return'<my-child-component data-a1="a"></my-child-component>'}};const d={name:"componentOne",data:()=>({a:5,c:"Hello there!!",e:{f:5,g:6}}),computed:{b:function(){return 10*this.a},d:function(){return this.b+11},nestedComputed:function(){return isNaN(this.e.f)||isNaN(this.e.g)?0:this.e.f*this.e.g}},el:"componentOne",templates:[{html:s.templateForA,id:"a",prop:"a"},{html:s.templateForB,id:"b",prop:"b"},{html:s.templateForC,id:"c",prop:"c"},{html:s.templateForD,id:"d",prop:"d"},{html:s.templateForF,id:"f",prop:"e.f"},{html:s.templateForG,id:"g",prop:"e.g"},{html:s.templateForH,id:"h",prop:"nestedComputed"}],components:[{name:"my-child-component",value:{name:"childComponent",el:"childComponent",props:["a1"],data:()=>({b1:10}),templates:[{html:s.templateAForComponentB,id:"child_a",prop:"a1"},{html:s.templateBForComponentB,id:"child_b",prop:"b1"}]},template:s.templateForChildComponentPlaceholder}]};document.getElementById("inputA").onchange=function(t){let e=document.getElementById("inputA").value;isNaN(e)||(f.a=e)},document.getElementById("inputC").onchange=function(t){let e=document.getElementById("inputC").value;f.c=e},document.getElementById("inputF").onchange=function(t){let e=document.getElementById("inputF").value;f.e.f=e},document.getElementById("inputG").onchange=function(t){let e=document.getElementById("inputG").value;f.e.g=e};let f=m(d);console.log(f),setTimeout(()=>{f.c="hello Chicago!!"},2e3)}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9SZWFjdGl2aXR5L3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL1JlYWN0aXZpdHkvLi9nbG9iYWxzLmpzIiwid2VicGFjazovL1JlYWN0aXZpdHkvLi9yZWFjdGl2ZS9kZXAuanMiLCJ3ZWJwYWNrOi8vUmVhY3Rpdml0eS8uL3JlYWN0aXZlL3dhdGNoZXIuanMiLCJ3ZWJwYWNrOi8vUmVhY3Rpdml0eS8uL3JlYWN0aXZlL2JpbmRQcm9wLmpzIiwid2VicGFjazovL1JlYWN0aXZpdHkvLi91dGlscy5qcyIsIndlYnBhY2s6Ly9SZWFjdGl2aXR5Ly4vcmVuZGVyLmpzIiwid2VicGFjazovL1JlYWN0aXZpdHkvLi9yZWFjdGl2ZS9vYnNlcnZlci5qcyIsIndlYnBhY2s6Ly9SZWFjdGl2aXR5Ly4vdGVtcGxhdGVzLmpzIiwid2VicGFjazovL1JlYWN0aXZpdHkvLi9jb21wb25lbnRzLmpzIiwid2VicGFjazovL1JlYWN0aXZpdHkvLi90ZXN0LmpzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJjb25maWd1cmFibGUiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsInZhbHVlIiwibiIsIl9fZXNNb2R1bGUiLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJnbG9iYWxXYXRjaGVyQ291bnQiLCJnbG9iYWxEZXBUcmFja2VyQ291bnQiLCJEZXAiLCJ0aGlzIiwic3Vic2NyaWJlcnMiLCJkZXBlbmQiLCJ1bmRlZmluZWQiLCJmaW5kIiwidiIsImlkIiwicHVzaCIsIm5vdGlmeSIsImZvckVhY2giLCJjb25zb2xlIiwibG9nIiwidXBkYXRlIiwidGFyZ2V0IiwiV2F0Y2hlciIsImNiIiwidm0iLCJhcmdzIiwiYXBwbHkiLCJiaW5kUHJvcFRvVGVtcGxhdGUiLCJ0ZW1wbGF0ZSIsInByb3AiLCJjb21wb25lbnRJZCIsInJlbmRlciIsImluZGV4T2YiLCJwcm9wcyIsIl9wcm9wcyIsInNwbGl0IiwibGVuZ3RoIiwidHJhdmVyc2VUb1Byb3AiLCJoaWdobGlnaHQiLCJjbGFzc05hbWUiLCJlbCIsInRpbWVvdXQiLCJjbGFzc0xpc3QiLCJhZGQiLCJzZXRUaW1lb3V0IiwicmVtb3ZlIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImNvbXBvbmVudFJvb3QiLCJjcmVhdGVFbGVtZW50IiwiaW5uZXJIVE1MIiwiYXBwZW5kQ2hpbGQiLCJpbml0RGF0YSIsIm9iaiIsInJlYWN0aXZlIiwibmVzdGVkIiwid3JhcHBlciIsInZhbCIsImRlcCIsInNldCIsIm5ld1ZhbCIsIm1ha2VSZWFjdGl2ZSIsInByb3BWYWx1ZUhhc2giLCJwYXJlbnQiLCJjb21wdXRlZCIsInRlbXBsYXRlcyIsImNvbXBvbmVudHMiLCJkYXRhIiwiY29tcHV0ZWRXYXRjaGVycyIsImNvbXB1dGVkRGVwcyIsImNhY2hlZFZhbHVlIiwiaW5pdENvbXB1dGVkIiwiaW5pdFByb3BzIiwiaHRtbCIsImluaXRUZW1wbGF0ZXMiLCJjb21wb25lbnQiLCJ3YXJuIiwiYXR0cnMiLCJhdHRyIiwia3ZwIiwiSlNPTiIsInN0cmluZ2lmeSIsImluaXRDb21wb25lbnRzIiwidGVtcGxhdGVzXzAiLCJ0ZW1wbGF0ZUZvckEiLCJhIiwidGVtcGxhdGVGb3JCIiwiYiIsInRlbXBsYXRlRm9yQyIsInRlbXBsYXRlRm9yRCIsInRlbXBsYXRlRm9yRiIsImUiLCJmIiwidGVtcGxhdGVGb3JHIiwiZyIsInRlbXBsYXRlRm9ySCIsIm5lc3RlZENvbXB1dGVkIiwidGVtcGxhdGVBRm9yQ29tcG9uZW50QiIsImExIiwidGVtcGxhdGVCRm9yQ29tcG9uZW50QiIsImIxIiwidGVtcGxhdGVGb3JDaGlsZENvbXBvbmVudFBsYWNlaG9sZGVyIiwiY29tcG9uZW50T25lIiwiaXNOYU4iLCJvbmNoYW5nZSIsIm15Rmlyc3RSZWFjdGl2ZUNvbXBvbmVudCJdLCJtYXBwaW5ncyI6IjJCQUNBLElBQUFBLEtBR0EsU0FBQUMsRUFBQUMsR0FHQSxHQUFBRixFQUFBRSxHQUNBLE9BQUFGLEVBQUFFLEdBQUFDLFFBR0EsSUFBQUMsRUFBQUosRUFBQUUsSUFDQUcsRUFBQUgsRUFDQUksR0FBQSxFQUNBSCxZQVVBLE9BTkFJLEVBQUFMLEdBQUFNLEtBQUFKLEVBQUFELFFBQUFDLElBQUFELFFBQUFGLEdBR0FHLEVBQUFFLEdBQUEsRUFHQUYsRUFBQUQsUUEyQ0EsT0F0Q0FGLEVBQUFRLEVBQUFGLEVBR0FOLEVBQUFTLEVBQUFWLEVBR0FDLEVBQUFVLEVBQUEsU0FBQVIsRUFBQVMsRUFBQUMsR0FDQVosRUFBQWEsRUFBQVgsRUFBQVMsSUFDQUcsT0FBQUMsZUFBQWIsRUFBQVMsR0FDQUssY0FBQSxFQUNBQyxZQUFBLEVBQ0FDLElBQUFOLEtBTUFaLEVBQUFtQixFQUFBLFNBQUFqQixHQUNBWSxPQUFBQyxlQUFBYixFQUFBLGNBQWlEa0IsT0FBQSxLQUlqRHBCLEVBQUFxQixFQUFBLFNBQUFsQixHQUNBLElBQUFTLEVBQUFULEtBQUFtQixXQUNBLFdBQTJCLE9BQUFuQixFQUFBLFNBQzNCLFdBQWlDLE9BQUFBLEdBRWpDLE9BREFILEVBQUFVLEVBQUFFLEVBQUEsSUFBQUEsR0FDQUEsR0FJQVosRUFBQWEsRUFBQSxTQUFBVSxFQUFBQyxHQUFzRCxPQUFBVixPQUFBVyxVQUFBQyxlQUFBbkIsS0FBQWdCLEVBQUFDLElBR3REeEIsRUFBQTJCLEVBQUEsSUFJQTNCLElBQUE0QixFQUFBLHlDQ2xFQSxJQUFBQyxFQUFBLEVBQ0FDLEVBQUEsRUNBQSxNQUFBQyxFQUFBLFNBQUFwQixHQUNBcUIsS0FBQUMsZUFDQUQsS0FBQUUsT0FBQSxTQUFBTixRQUNBTyxJQUFBSCxLQUFBQyxZQUFBRyxLQUFBQyxLQUFBQyxLQUFBVixFQUFBVSxL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QUlBLElBQUFnRCxFQUFBNUMsRUFBQXlDLEdBQ0FwRixRQUFBQyxJQUFBc0YsR0FDQTdELFdBQUEsS0FDQTZELEVBQUF4SCxFQUFBLG1CQUNDIiwiZmlsZSI6ImJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwge1xuIFx0XHRcdFx0Y29uZmlndXJhYmxlOiBmYWxzZSxcbiBcdFx0XHRcdGVudW1lcmFibGU6IHRydWUsXG4gXHRcdFx0XHRnZXQ6IGdldHRlclxuIFx0XHRcdH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIi9cIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDApO1xuIiwiLy9HbG9iYWwgdmFyaWFibGVzXHJcbmxldCBnbG9iYWxXYXRjaGVyQ291bnQgPSAwXHJcbmxldCBnbG9iYWxEZXBUcmFja2VyQ291bnQgPSAwXHJcbmV4cG9ydCB7Z2xvYmFsV2F0Y2hlckNvdW50LCBnbG9iYWxEZXBUcmFja2VyQ291bnR9IiwiIGltcG9ydCB7Z2xvYmFsRGVwVHJhY2tlckNvdW50fSBmcm9tICcuLi9nbG9iYWxzLmpzJ1xyXG4gLy9EZXBlbmRlbmN5IFRyYWNrZXIsIG1haW50YWlucyBhIGxpc3Qgb2Ygc3Vic2NyaWJlcnMsIGFuZCBhbiBhY3RpdmUgdGFyZ2V0IChjYW4gb25seSBiZSBvbmUgYXQgYW55IHBvaW50IGluIHRpbWUpXHJcbmNvbnN0IERlcCA9IGZ1bmN0aW9uKG5hbWUpIHtcclxuICB0aGlzLnN1YnNjcmliZXJzID0gW11cclxuICB0aGlzLmRlcGVuZCA9IGZ1bmN0aW9uKHMpIHtcclxuICAgIGlmICh0aGlzLnN1YnNjcmliZXJzLmZpbmQodiA9PiB2LmlkID09PSBzLmlkKSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIHRoaXMuc3Vic2NyaWJlcnMucHVzaChzKVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgLy8gY29uc29sZS5sb2cocy5pZCArICcgaGFzIGFscmVhZHkgc3Vic2NyaWJlZCBmb3IgJyArIHRoaXMuaWQpXHJcbiAgICB9XHJcbiAgfVxyXG4gIHRoaXMubm90aWZ5ID0gZnVuY3Rpb24oKSB7XHJcbiAgICB0aGlzLnN1YnNjcmliZXJzLmZvckVhY2goKHMpID0+IHtcclxuICAgICAgY29uc29sZS5sb2codGhpcy5uYW1lICsgJyBub3RpZnlpbmcgJyArIHMubmFtZSlcclxuICAgICAgcy51cGRhdGUoKVxyXG4gICAgfSlcclxuICB9XHJcbiAgdGhpcy5pZCA9IGdsb2JhbERlcFRyYWNrZXJDb3VudCsrXHJcbiAgdGhpcy5uYW1lID0gbmFtZVxyXG59XHJcbkRlcC50YXJnZXQgPSBudWxsXHJcbmV4cG9ydCB7RGVwfVxyXG4iLCJpbXBvcnQge2dsb2JhbFdhdGNoZXJDb3VudH0gZnJvbSAnLi4vZ2xvYmFscy5qcydcclxuLy9XYXRjaGVyIC0gYXR0YWNoZXMgYXMgYW4gYWN0aXZlIGRlcCB0YXJnZXQsIGZpcmVzIHRoZSB1cGRhdGUgY2FsbGJhY2tcclxuZXhwb3J0IGNvbnN0IFdhdGNoZXIgPSBmdW5jdGlvbihuYW1lLCBjYiwgdm0sIC4uLmFyZ3MpIHtcclxuICAgIHRoaXMudXBkYXRlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgIGNiLmFwcGx5KHZtLCBhcmdzKVxyXG4gICAgfVxyXG4gICAgdGhpcy5pZCA9IGdsb2JhbFdhdGNoZXJDb3VudCsrXHJcbiAgICB0aGlzLm5hbWUgPSBuYW1lXHJcbn0iLCIgIGltcG9ydCB7RGVwfSBmcm9tICcuL2RlcC5qcydcclxuICBpbXBvcnQge1dhdGNoZXJ9IGZyb20gJy4vd2F0Y2hlci5qcydcclxuICBpbXBvcnQge3RyYXZlcnNlVG9Qcm9wfSBmcm9tICcuLi91dGlscy5qcydcclxuXHJcbiAgLy9GbiB0byBiaW5kIGNvbXBvbmVudCdzIHByb3BzIHRvIGh0bWwgdGVtcGxhdGVcclxuICBleHBvcnQgY29uc3QgYmluZFByb3BUb1RlbXBsYXRlID0gZnVuY3Rpb24odGVtcGxhdGUsIGlkLCBwcm9wLCBjb21wb25lbnRJZCkge1xyXG4gICAgY29uc29sZS5sb2coXCJiaW5kUHJvcFRvVGVtcGxhdGU6XCIgKyBpZCArIFwiOlwiICsgdGhpc1twcm9wXSlcclxuICAgIERlcC50YXJnZXQgPSBuZXcgV2F0Y2hlcignQmluZGluZyBwcm9wIFdhdGNoZXI6ICcgKyBpZCwgdGhpcy5yZW5kZXIsIHRoaXMsIHRlbXBsYXRlLCBpZCwgY29tcG9uZW50SWQpXHJcbiAgICBsZXQgdmFsID0gdHlwZW9mKHRoaXNbcHJvcF0pID09PSBcImZ1bmN0aW9uXCIgPyB0aGlzW3Byb3BdLmFwcGx5KHRoaXMpIDogcHJvcC5pbmRleE9mKCcuJykgIT09IC0xID8gdHJhdmVyc2VUb1Byb3AodGhpcywgcHJvcCkgOiB0aGlzW3Byb3BdXHJcbiAgICBEZXAudGFyZ2V0ID0gbnVsbFxyXG4gIH0iLCIvL1RyYXZlcnNlIHRvIHRoZSBuZXN0ZWQgcHJvcFxyXG5jb25zdCB0cmF2ZXJzZVRvUHJvcCA9ICh0YXJnZXQsIHByb3BzKSA9PiB7XHJcbiAgICBsZXQgX3Byb3BzID0gcHJvcHMuc3BsaXQoJy4nKVxyXG4gICAgY29uc29sZS5sb2coX3Byb3BzKVxyXG4gICAgbGV0IHZhbCA9IHt9XHJcbiAgICBsZXQgbyA9IHRhcmdldFtfcHJvcHNbMF1dXHJcbiAgICBmb3IgKGxldCBpID0gMTsgaSA8IF9wcm9wcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICBvID0gb1tfcHJvcHNbaV1dXHJcbiAgICB9XHJcbiAgICByZXR1cm4gb1xyXG4gIH1cclxuICBcclxuICBleHBvcnQge3RyYXZlcnNlVG9Qcm9wfVxyXG4gXHJcbiAgIiwiY29uc3QgaGlnaGxpZ2h0ID0gKGNsYXNzTmFtZSwgZWwsIHRpbWVvdXQpID0+IHtcclxuICAgIGVsLmNsYXNzTGlzdC5hZGQoY2xhc3NOYW1lKVxyXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgZWwuY2xhc3NMaXN0LnJlbW92ZShjbGFzc05hbWUpXHJcbiAgICB9LCB0aW1lb3V0KVxyXG59XHJcblxyXG4vL29ubHkgdGhpcyBndXkgc2hvdWxkIHRvdWNoIHRoZSBET00sIGtpZGRpbmcgbm90XHJcbmV4cG9ydCBjb25zdCByZW5kZXIgPSBmdW5jdGlvbiAodGVtcGxhdGUsIGlkLCBjb21wb25lbnRJZCkge1xyXG4gICAgbGV0IGVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpXHJcbiAgICBpZiAoIWVsKSB7XHJcbiAgICAgICAgbGV0IGNvbXBvbmVudFJvb3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChjb21wb25lbnRJZClcclxuICAgICAgICBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXHJcbiAgICAgICAgZWwuaWQgPSBpZFxyXG4gICAgICAgIGVsLmlubmVySFRNTCA9IHRlbXBsYXRlLmFwcGx5KHRoaXMpXHJcbiAgICAgICAgY29tcG9uZW50Um9vdC5hcHBlbmRDaGlsZChlbClcclxuICAgICAgICBoaWdobGlnaHQoJ2luaXRQcm9wcycsIGVsLCAxMDAwKVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgaGlnaGxpZ2h0KCdhY3RpdmVQcm9wcycsIGVsLCAzMDAwKVxyXG4gICAgfVxyXG59XHJcblxyXG4iLCJcclxuaW1wb3J0IHsgRGVwIH0gZnJvbSAnLi9kZXAuanMnXHJcbmltcG9ydCB7IFdhdGNoZXIgfSBmcm9tICcuL3dhdGNoZXIuanMnXHJcbmltcG9ydCB7IGJpbmRQcm9wVG9UZW1wbGF0ZSB9IGZyb20gJy4vYmluZFByb3AuanMnXHJcbmltcG9ydCB7IHJlbmRlciB9IGZyb20gJy4uL3JlbmRlci5qcydcclxuXHJcbmNvbnN0IGluaXREYXRhID0gZnVuY3Rpb24gKG9iaiwgcmVhY3RpdmUsIG5lc3RlZCkge1xyXG4gIGlmICh0eXBlb2Ygb2JqICE9PSAnb2JqZWN0Jykge1xyXG4gICAgcmV0dXJuIG9ialxyXG4gIH1cclxuICBsZXQgd3JhcHBlciA9IHt9XHJcblxyXG4gIGZvciAobGV0IHByb3AgaW4gb2JqKSB7XHJcbiAgICBsZXQgdmFsID0gb2JqW3Byb3BdXHJcbiAgICBpZiAodHlwZW9mIG9ialtwcm9wXSA9PT0gXCJvYmplY3RcIikge1xyXG4gICAgICB2YWwgPSBpbml0RGF0YShvYmpbcHJvcF0sIHJlYWN0aXZlLCB0cnVlKVxyXG4gICAgfVxyXG4gICAgbGV0IGRlcCA9IG5ldyBEZXAocHJvcClcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuZXN0ZWQgPyB3cmFwcGVyIDogcmVhY3RpdmUsIHByb3AsIHtcclxuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKERlcC50YXJnZXQpIHtcclxuICAgICAgICAgIGRlcC5kZXBlbmQoRGVwLnRhcmdldClcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHZhbFxyXG4gICAgICB9LFxyXG4gICAgICBzZXQ6IGZ1bmN0aW9uIChuZXdWYWwpIHtcclxuICAgICAgICB2YWwgPSBpbml0RGF0YShuZXdWYWwsIHJlYWN0aXZlKVxyXG4gICAgICAgIGRlcC5ub3RpZnkoKVxyXG4gICAgICB9XHJcbiAgICB9KVxyXG4gIH1cclxuICByZXR1cm4gbmVzdGVkID8gd3JhcHBlciA6IHJlYWN0aXZlXHJcbn1cclxuXHJcbmNvbnN0IG1ha2VSZWFjdGl2ZSA9IGZ1bmN0aW9uICh2bSwgcHJvcFZhbHVlSGFzaCwgcGFyZW50KSB7XHJcbiAgY29uc3QgY29tcHV0ZWQgPSB2bS5jb21wdXRlZFxyXG4gIGNvbnN0IHRlbXBsYXRlcyA9IHZtLnRlbXBsYXRlc1xyXG4gIGNvbnN0IHByb3BzID0gdm0ucHJvcHMgfHwgW11cclxuICBjb25zdCBjb21wb25lbnRzID0gdm0uY29tcG9uZW50cyB8fCBbXVxyXG4gIGNvbnN0IGRhdGEgPSAodm0uZGF0YSAmJiB2bS5kYXRhKCkpIHx8IHt9XHJcbiAgbGV0IHJlYWN0aXZlID0ge31cclxuXHJcbiAgcmVhY3RpdmUucmVuZGVyID0gcmVuZGVyXHJcbiAgcmVhY3RpdmUuYmluZFByb3BUb1RlbXBsYXRlID0gYmluZFByb3BUb1RlbXBsYXRlXHJcbiAgcmVhY3RpdmUubmFtZSA9IHZtLm5hbWVcclxuICByZWFjdGl2ZS5lbCA9IHZtLmVsXHJcbiAgXHJcbiAgaW5pdERhdGEoZGF0YSwgcmVhY3RpdmUpXHJcblxyXG4gIGluaXRDb21wdXRlZChyZWFjdGl2ZSwgY29tcHV0ZWQpXHJcblxyXG4gIGluaXRQcm9wcyhyZWFjdGl2ZSwgcHJvcHMsIHByb3BWYWx1ZUhhc2gsIHBhcmVudClcclxuXHJcbiAgaW5pdFRlbXBsYXRlcyhyZWFjdGl2ZSwgdGVtcGxhdGVzKVxyXG5cclxuICBpbml0Q29tcG9uZW50cyhyZWFjdGl2ZSwgY29tcG9uZW50cylcclxuXHJcbiAgcmV0dXJuIHJlYWN0aXZlXHJcbn1cclxuXHJcbmZ1bmN0aW9uIGluaXRDb21wdXRlZChyZWFjdGl2ZSwgY29tcHV0ZWQpIHtcclxuICBsZXQgY29tcHV0ZWRXYXRjaGVycyA9IHt9XHJcbiAgbGV0IGNvbXB1dGVkRGVwcyA9IHt9XHJcblxyXG4gIC8vUmVhY3RpdmUgY29tcHV0ZWQgcHJvcHNcclxuICBmb3IgKGxldCBwcm9wIGluIGNvbXB1dGVkKSB7XHJcbiAgICBsZXQgY2FjaGVkVmFsdWUgPSBudWxsXHJcbiAgICAvL0NvbXB1dGVkIHByb3BlcnRpZXMgZ2V0cyB0aGVpciBvd24gd2F0Y2hlcnMgd2hpY2ggcmVjb21wdXRlIHRoZSBmbiBhbmQgbm90aWZ5IGl0cyBkZXBlbmRlbnRzXHJcbiAgICBjb21wdXRlZFdhdGNoZXJzW3Byb3BdID0gbmV3IFdhdGNoZXIoJ0NvbXB1dGVkIHdhdGNoZXIgcHJvcDogJyArIHByb3AsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgY2FjaGVkVmFsdWUgPSBjb21wdXRlZFtwcm9wXS5hcHBseShyZWFjdGl2ZSlcclxuICAgICAgY29tcHV0ZWREZXBzW3Byb3BdLm5vdGlmeSgpXHJcbiAgICB9LCBudWxsKVxyXG5cclxuICAgIERlcC50YXJnZXQgPSBjb21wdXRlZFdhdGNoZXJzW3Byb3BdXHJcbiAgICBjYWNoZWRWYWx1ZSA9IGNvbXB1dGVkW3Byb3BdLmFwcGx5KHJlYWN0aXZlKVxyXG4gICAgRGVwLnRhcmdldCA9IG51bGxcclxuXHJcbiAgICBjb21wdXRlZERlcHNbcHJvcF0gPSBuZXcgRGVwKHByb3ApXHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkocmVhY3RpdmUsIHByb3AsIHtcclxuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKERlcC50YXJnZXQpIHtcclxuICAgICAgICAgIGNvbXB1dGVkRGVwc1twcm9wXS5kZXBlbmQoRGVwLnRhcmdldClcclxuICAgICAgICAgIERlcC50YXJnZXQgPSBudWxsXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBjYWNoZWRWYWx1ZVxyXG4gICAgICB9XHJcbiAgICB9KVxyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gaW5pdFByb3BzKHJlYWN0aXZlLCBwcm9wcywgcHJvcFZhbHVlSGFzaCwgcGFyZW50KSB7XHJcbiAgZm9yIChsZXQgcHJvcCBvZiBwcm9wcykge1xyXG4gICAgbGV0IGRlcCA9IG5ldyBEZXAocHJvcClcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShyZWFjdGl2ZSwgcHJvcCwge1xyXG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAoRGVwLnRhcmdldCkge1xyXG4gICAgICAgICAgZGVwLmRlcGVuZChEZXAudGFyZ2V0KVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcGFyZW50W3Byb3BWYWx1ZUhhc2hbcHJvcF1dXHJcbiAgICAgIH1cclxuICAgIH0pXHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBpbml0VGVtcGxhdGVzKHJlYWN0aXZlLCB0ZW1wbGF0ZXMpIHtcclxuICBmb3IgKGxldCB0ZW1wbGF0ZSBvZiB0ZW1wbGF0ZXMpIHtcclxuICAgIHJlYWN0aXZlLmJpbmRQcm9wVG9UZW1wbGF0ZSh0ZW1wbGF0ZS5odG1sLCB0ZW1wbGF0ZS5pZCwgdGVtcGxhdGUucHJvcClcclxuICAgIHJlYWN0aXZlLnJlbmRlcih0ZW1wbGF0ZS5odG1sLCB0ZW1wbGF0ZS5pZCwgcmVhY3RpdmUuZWwpXHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBpbml0Q29tcG9uZW50cyhyZWFjdGl2ZSwgY29tcG9uZW50cykge1xyXG4gIGZvciAobGV0IGNvbXBvbmVudCBvZiBjb21wb25lbnRzKSB7XHJcbiAgICBsZXQgdGVtcGxhdGUgPSBjb21wb25lbnQudGVtcGxhdGUoKVxyXG4gICAgbGV0IG5hbWUgPSBjb21wb25lbnQubmFtZVxyXG4gICAgbGV0IHZhbHVlID0gY29tcG9uZW50LnZhbHVlXHJcbiAgICBsZXQgY2hpbGRUZW1wbGF0ZXMgPSB2YWx1ZS50ZW1wbGF0ZXNcclxuICAgIGlmICh0ZW1wbGF0ZS5pbmRleE9mKG5hbWUpID09PSAtMSkge1xyXG4gICAgICBjb25zb2xlLndhcm4oYCR7bmFtZX0gbm90IGRlZmluZWQgaW4gdGhlIHRlbXBsYXRlYClcclxuICAgICAgYnJlYWtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGxldCBhdHRycyA9IHRlbXBsYXRlLnNwbGl0KCc8LycgKyBuYW1lICsgJz4nKVswXS5zcGxpdCgnZGF0YS0nKVxyXG4gICAgICBsZXQgcHJvcFZhbHVlSGFzaCA9IHt9XHJcbiAgICAgIGZvciAobGV0IGF0dHIgb2YgYXR0cnMpIHtcclxuICAgICAgICBpZiAoYXR0ci5pbmRleE9mKCc9JykgIT09IC0xKSB7XHJcbiAgICAgICAgICBsZXQga3ZwID0gYXR0ci5zcGxpdCgnPScpXHJcbiAgICAgICAgICBwcm9wVmFsdWVIYXNoW2t2cFswXV0gPSBrdnBbMV0uc3BsaXQoJ1wiJylbMV1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgY29uc29sZS5sb2coJ3Byb3BWYWx1ZUhhc2g6JyArIEpTT04uc3RyaW5naWZ5KHByb3BWYWx1ZUhhc2gpKVxyXG4gICAgICBtYWtlUmVhY3RpdmUodmFsdWUsIHByb3BWYWx1ZUhhc2gsIHJlYWN0aXZlKVxyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IHsgbWFrZVJlYWN0aXZlIH1cclxuXHJcbiIsIlxyXG5sZXQgdGVtcGxhdGVGb3JBID0gZnVuY3Rpb24oKSB7XHJcbiAgICByZXR1cm4gYDxwPkhlbGxvLCBJIGFtIGEgPGk+ZGF0YTwvaT4gcHJvcC4gWW91IGNhbiBjYWxsIG1lIDxzdHJvbmc+QTwvc3Ryb25nPjogJHt0aGlzLmF9PC9wPmBcclxuICB9XHJcbiAgXHJcbiAgbGV0IHRlbXBsYXRlRm9yQiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgcmV0dXJuIGA8cD5IZWxsbywgSSBhbSBhIDxpPmNvbXB1dGVkPC9pPiBwcm9wLiBZb3UgY2FuIGNhbGwgbWUgPHN0cm9uZz5CPC9zdHJvbmc+IChBICogMTApOiAke3RoaXMuYn08L3A+YFxyXG4gIH1cclxuICBcclxuICBsZXQgdGVtcGxhdGVGb3JDID0gZnVuY3Rpb24oKSB7XHJcbiAgICByZXR1cm4gYDxwPkhlbGxvLCBJIGFtIGEgPGk+ZGF0YTwvaT4gcHJvcC4gWW91IGNhbiBjYWxsIG1lIDxzdHJvbmc+Qzwvc3Ryb25nPjogJHt0aGlzLmN9PC9wPmBcclxuICB9XHJcbiAgXHJcbiAgbGV0IHRlbXBsYXRlRm9yRCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgcmV0dXJuIGA8cD5IZWxsbywgSSBhbSBhIDxpPmNvbXB1dGVkPC9pPiBwcm9wLiBZb3UgY2FuIGNhbGwgbWUgPHN0cm9uZz5EPC9zdHJvbmc+IChCICsgMTEpOiAke3RoaXMuZH08L3A+YFxyXG4gIH1cclxuICBcclxuICBcclxuICBsZXQgdGVtcGxhdGVGb3JGID0gZnVuY3Rpb24oKSB7XHJcbiAgICByZXR1cm4gYDxwPkhlbGxvLCBJIGFtIGEgPGk+bmVzdGVkIGRhdGE8L2k+IHByb3AuIFlvdSBjYW4gY2FsbCBtZSA8c3Ryb25nPkY8L3N0cm9uZz4oTGVuZ3RoKTogJHt0aGlzLmUuZn08L3A+YFxyXG4gIH1cclxuICBcclxuICBsZXQgdGVtcGxhdGVGb3JHID0gZnVuY3Rpb24oKSB7XHJcbiAgICByZXR1cm4gYDxwPkhlbGxvLCBJIGFtIGEgPGk+bmVzdGVkIGRhdGE8L2k+IHByb3AuIFlvdSBjYW4gY2FsbCBtZSA8c3Ryb25nPkc8L3N0cm9uZz4oV2lkdGgpOiAke3RoaXMuZS5nfTwvcD5gXHJcbiAgfVxyXG4gIFxyXG4gIGxldCB0ZW1wbGF0ZUZvckggPSBmdW5jdGlvbigpIHtcclxuICAgIHJldHVybiBgPHA+SGVsbG8sIEkgYW0gYSA8aT5uZXN0ZWQgY29tcHV0ZWQ8L2k+IHByb3AuIFlvdSBjYW4gY2FsbCBtZSA8c3Ryb25nPkg8L3N0cm9uZz4oQXJlYSk6ICR7dGhpcy5uZXN0ZWRDb21wdXRlZH08L3A+YFxyXG4gIH1cclxuICBcclxuICBsZXQgdGVtcGxhdGVBRm9yQ29tcG9uZW50QiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgcmV0dXJuIGA8cD5JJ20gYSBjaGlsZCBjb21wb25lbnQgSSBoYXZlIGluaGVyaXRlZCBteSBwYXJlbnQncyBwcm9wZXJ0eSBhOiAke3RoaXMuYTF9PC9wPmBcclxuICB9XHJcbiAgXHJcbiAgbGV0IHRlbXBsYXRlQkZvckNvbXBvbmVudEIgPSBmdW5jdGlvbigpIHtcclxuICAgIHJldHVybiBgPHA+SSdtIGEgY2hpbGQgY29tcG9uZW50LiBUaGlzIGlzIG15IHByb3BlcnR5IEIxOiAke3RoaXMuYjF9PC9wPmBcclxuICB9XHJcbiAgXHJcbiAgbGV0IHRlbXBsYXRlRm9yQ2hpbGRDb21wb25lbnRQbGFjZWhvbGRlciA9IGZ1bmN0aW9uKCkge1xyXG4gICAgcmV0dXJuIGA8bXktY2hpbGQtY29tcG9uZW50IGRhdGEtYTE9XCJhXCI+PC9teS1jaGlsZC1jb21wb25lbnQ+YFxyXG4gIH1cclxuXHJcbiAgZXhwb3J0IGRlZmF1bHQge1xyXG4gICAgICB0ZW1wbGF0ZUZvckEsXHJcbiAgICAgIHRlbXBsYXRlRm9yQixcclxuICAgICAgdGVtcGxhdGVGb3JDLFxyXG4gICAgICB0ZW1wbGF0ZUZvckQsXHJcbiAgICAgIHRlbXBsYXRlRm9yRixcclxuICAgICAgdGVtcGxhdGVGb3JHLFxyXG4gICAgICB0ZW1wbGF0ZUZvckgsXHJcbiAgICAgIHRlbXBsYXRlQUZvckNvbXBvbmVudEIsXHJcbiAgICAgIHRlbXBsYXRlQkZvckNvbXBvbmVudEIsXHJcbiAgICAgIHRlbXBsYXRlRm9yQ2hpbGRDb21wb25lbnRQbGFjZWhvbGRlclxyXG4gIH0iLCIvL0NvbXBvbmVudCBEZWZpbml0aW9uc1xyXG5pbXBvcnQgdGVtcCBmcm9tICcuL3RlbXBsYXRlcy5qcydcclxuY29uc3QgY2hpbGRDb21wb25lbnQgPSB7XHJcbiAgICBuYW1lOiAnY2hpbGRDb21wb25lbnQnLFxyXG4gICAgZWw6ICdjaGlsZENvbXBvbmVudCcsXHJcbiAgICBwcm9wczogWydhMSddLFxyXG4gICAgZGF0YSgpIHtcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBiMTogMTBcclxuICAgICAgfVxyXG4gICAgfSxcclxuICAgIHRlbXBsYXRlczogW3tcclxuICAgICAgICBodG1sOiB0ZW1wLnRlbXBsYXRlQUZvckNvbXBvbmVudEIsXHJcbiAgICAgICAgaWQ6IFwiY2hpbGRfYVwiLFxyXG4gICAgICAgIHByb3A6IFwiYTFcIlxyXG4gICAgICB9LFxyXG4gICAgICB7XHJcbiAgICAgICAgaHRtbDogdGVtcC50ZW1wbGF0ZUJGb3JDb21wb25lbnRCLFxyXG4gICAgICAgIGlkOiBcImNoaWxkX2JcIixcclxuICAgICAgICBwcm9wOiBcImIxXCJcclxuICAgICAgfVxyXG4gICAgXVxyXG4gIH1cclxuICBcclxuICBjb25zdCBjb21wb25lbnRPbmUgPSB7XHJcbiAgICBuYW1lOiAnY29tcG9uZW50T25lJyxcclxuICAgIGRhdGEoKSB7XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgYTogNSxcclxuICAgICAgICBjOiAnSGVsbG8gdGhlcmUhIScsXHJcbiAgICAgICAgZToge1xyXG4gICAgICAgICAgZjogNSxcclxuICAgICAgICAgIGc6IDZcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0sXHJcbiAgICBjb21wdXRlZDoge1xyXG4gICAgICBiOiBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5hICogMTBcclxuICAgICAgfSxcclxuICAgICAgZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYiArIDExXHJcbiAgICAgIH0sXHJcbiAgICAgIG5lc3RlZENvbXB1dGVkOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAoaXNOYU4odGhpcy5lLmYpIHx8IGlzTmFOKHRoaXMuZS5nKSkge1xyXG4gICAgICAgICAgcmV0dXJuIDBcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZS5mICogdGhpcy5lLmdcclxuICAgICAgfVxyXG4gICAgfSxcclxuICAgIGVsOiAnY29tcG9uZW50T25lJyxcclxuICAgIHRlbXBsYXRlczogW3tcclxuICAgICAgICBodG1sOiB0ZW1wLnRlbXBsYXRlRm9yQSxcclxuICAgICAgICBpZDogXCJhXCIsXHJcbiAgICAgICAgcHJvcDogXCJhXCJcclxuICAgICAgfSxcclxuICAgICAge1xyXG4gICAgICAgIGh0bWw6IHRlbXAudGVtcGxhdGVGb3JCLFxyXG4gICAgICAgIGlkOiBcImJcIixcclxuICAgICAgICBwcm9wOiBcImJcIlxyXG4gICAgICB9LFxyXG4gICAgICB7XHJcbiAgICAgICAgaHRtbDogdGVtcC50ZW1wbGF0ZUZvckMsXHJcbiAgICAgICAgaWQ6IFwiY1wiLFxyXG4gICAgICAgIHByb3A6IFwiY1wiXHJcbiAgICAgIH0sXHJcbiAgICAgIHtcclxuICAgICAgICBodG1sOiB0ZW1wLnRlbXBsYXRlRm9yRCxcclxuICAgICAgICBpZDogXCJkXCIsXHJcbiAgICAgICAgcHJvcDogXCJkXCJcclxuICAgICAgfSxcclxuICAgICAge1xyXG4gICAgICAgIGh0bWw6IHRlbXAudGVtcGxhdGVGb3JGLFxyXG4gICAgICAgIGlkOiBcImZcIixcclxuICAgICAgICBwcm9wOiBcImUuZlwiXHJcbiAgICAgIH0sXHJcbiAgICAgIHtcclxuICAgICAgICBodG1sOiB0ZW1wLnRlbXBsYXRlRm9yRyxcclxuICAgICAgICBpZDogXCJnXCIsXHJcbiAgICAgICAgcHJvcDogXCJlLmdcIlxyXG4gICAgICB9LFxyXG4gICAgICB7XHJcbiAgICAgICAgaHRtbDogdGVtcC50ZW1wbGF0ZUZvckgsXHJcbiAgICAgICAgaWQ6IFwiaFwiLFxyXG4gICAgICAgIHByb3A6IFwibmVzdGVkQ29tcHV0ZWRcIlxyXG4gICAgICB9XHJcbiAgICBdLFxyXG4gICAgY29tcG9uZW50czogW3tcclxuICAgICAgbmFtZTogJ215LWNoaWxkLWNvbXBvbmVudCcsXHJcbiAgICAgIHZhbHVlOiBjaGlsZENvbXBvbmVudCxcclxuICAgICAgdGVtcGxhdGU6IHRlbXAudGVtcGxhdGVGb3JDaGlsZENvbXBvbmVudFBsYWNlaG9sZGVyXHJcbiAgICB9XVxyXG4gIH1cclxuXHJcbiAgZXhwb3J0IHtjaGlsZENvbXBvbmVudCwgY29tcG9uZW50T25lfSIsImltcG9ydCB7bWFrZVJlYWN0aXZlfSBmcm9tICcuL3JlYWN0aXZlL29ic2VydmVyLmpzJ1xyXG5pbXBvcnQge2NvbXBvbmVudE9uZX0gZnJvbSAnLi9jb21wb25lbnRzLmpzJ1xyXG4vL0V2ZW50IGhhbmRsZXIgZm9yIGlucHV0IGNoYW5nZXNcclxuZnVuY3Rpb24gc2V0VmFsRm9yQShlKSB7XHJcbiAgICBsZXQgdmFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2lucHV0QScpLnZhbHVlO1xyXG4gICAgaWYgKCFpc05hTih2YWwpKSB7XHJcbiAgICAgIG15Rmlyc3RSZWFjdGl2ZUNvbXBvbmVudC5hID0gdmFsXHJcbiAgICB9XHJcbiAgfVxyXG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbnB1dEEnKS5vbmNoYW5nZSA9IHNldFZhbEZvckFcclxuICBcclxuICBmdW5jdGlvbiBzZXRWYWxGb3JDKGUpIHtcclxuICAgIGxldCB2YWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW5wdXRDJykudmFsdWU7XHJcbiAgICBteUZpcnN0UmVhY3RpdmVDb21wb25lbnQuYyA9IHZhbFxyXG4gIH1cclxuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW5wdXRDJykub25jaGFuZ2UgPSBzZXRWYWxGb3JDXHJcbiAgXHJcbiAgZnVuY3Rpb24gc2V0VmFsRm9yRihlKSB7XHJcbiAgICBsZXQgdmFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2lucHV0RicpLnZhbHVlO1xyXG4gICAgbXlGaXJzdFJlYWN0aXZlQ29tcG9uZW50LmUuZiA9IHZhbFxyXG4gIH1cclxuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW5wdXRGJykub25jaGFuZ2UgPSBzZXRWYWxGb3JGXHJcbiAgXHJcbiAgZnVuY3Rpb24gc2V0VmFsRm9yRyhlKSB7XHJcbiAgICBsZXQgdmFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2lucHV0RycpLnZhbHVlO1xyXG4gICAgbXlGaXJzdFJlYWN0aXZlQ29tcG9uZW50LmUuZyA9IHZhbFxyXG4gIH1cclxuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2lucHV0RycpLm9uY2hhbmdlID0gc2V0VmFsRm9yR1xyXG5cclxubGV0IG15Rmlyc3RSZWFjdGl2ZUNvbXBvbmVudCA9IG1ha2VSZWFjdGl2ZShjb21wb25lbnRPbmUpXHJcbmNvbnNvbGUubG9nKG15Rmlyc3RSZWFjdGl2ZUNvbXBvbmVudClcclxuc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgbXlGaXJzdFJlYWN0aXZlQ29tcG9uZW50LmMgPSBcImhlbGxvIENoaWNhZ28hIVwiXHJcbn0sIDIwMDApXHJcblxyXG4iXSwic291cmNlUm9vdCI6IiJ9