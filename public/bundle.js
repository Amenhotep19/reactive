var Reactivity=function(t){var e={};function n(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:o})},n.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/",n(n.s=0)}([function(t,e,n){"use strict";n.r(e);let o=0,r=0;const i=function(t){this.subscribers=[],this.depend=function(t){void 0===this.subscribers.find(e=>e.id===t.id)&&this.subscribers.push(t)},this.notify=function(){this.subscribers.forEach(t=>{console.log(this.name+" notifying "+t.name),t.update()})},this.id=r++,this.name=t};i.target=null;const l=function(t,e,n,...r){this.update=function(){e.apply(n,r)},this.id=o++,this.name=t},p=function(t,e,n){console.log("bindPropToTemplate:"+e+":"+this[n]),i.target=new l("Binding prop Watcher: "+e,this.render,this,t,e);"function"==typeof this[n]?this[n].apply(this):-1!==n.indexOf(".")?((t,e)=>{let n=e.split(".");console.log(n);let o=t[n[0]];for(let t=1;t<n.length;t++)o=o[n[t]]})(this,n):this[n];i.target=null},a=function(t,e){document.getElementById(e).innerHTML=t.apply(this)},c=function(t,e,n){if("object"!=typeof t)return t;let o={};for(let r in t){let l=t[r];"object"==typeof t[r]&&(l=c(t[r],e,!0));let p=new i(r);Object.defineProperty(n?o:e,r,{get:function(){return i.target&&p.depend(i.target),l},set:function(t){l=c(t,e),p.notify()}})}return n?o:e},u=function(t,e,n){let o={};o.render=a,o.bindPropToTemplate=p;const r=t.computed,m=t.templates,s=t.props||[],d=t.components||[],f=t.data&&t.data()||{};return c(f,o),function(t,e){let n={},o={};for(let t in e)n[t]=new l("Computed watcher prop: "+t,function(){o[t].notify()},null);for(let r in e)o[r]=new i(r),Object.defineProperty(t,r,{get:function(){i.target&&(o[r].depend(i.target),i.target=null),i.target=n[r];let t=e[r].apply(this);return i.target=null,t}})}(o,r),function(t,e,n,o){for(let r of e){let e=new i(r);Object.defineProperty(t,r,{get:function(){return i.target&&e.depend(i.target),o[n[r]]}})}}(o,s,e,n),function(t,e){for(let n of e)t.bindPropToTemplate(n.html,n.id,n.prop),t.render(n.html,n.id)}(o,m),function(t,e){for(let n of e){let e=n.template(),o=n.name,r=n.value;r.templates;if(-1===e.indexOf(o)){console.warn(`${o} not defined in the template`);break}{let n=e.split("</"+o+">")[0].split("data-"),i={};for(let t of n)if(-1!==t.indexOf("=")){let e=t.split("=");i[e[0]]=e[1].split('"')[1]}console.log("propValueHash:"+JSON.stringify(i)),u(r,i,t)}}}(o,d),o};var m={templateForA:function(){return`<p>Hello, I am a <i>data</i> prop. You can call me <strong>A</strong>: ${this.a}</p>`},templateForB:function(){return`<p>Hello, I am a <i>computed</i> prop. You can call me <strong>B</strong> (A * 10): ${this.b}</p>`},templateForC:function(){return`<p>Hello, I am a <i>data</i> prop. You can call me <strong>C</strong>: ${this.c}</p>`},templateForD:function(){return`<p>Hello, I am a <i>computed</i> prop. You can call me <strong>D</strong> (B + 11): ${this.d}</p>`},templateForF:function(){return`<p>Hello, I am a <i>nested data</i> prop. You can call me <strong>F</strong>(Length): ${this.e.f}</p>`},templateForG:function(){return`<p>Hello, I am a <i>nested data</i> prop. You can call me <strong>G</strong>(Width): ${this.e.g}</p>`},templateForH:function(){return`<p>Hello, I am a <i>nested computed</i> prop. You can call me <strong>H</strong>(Area): ${this.nestedComputed}</p>`},templateAForComponentB:function(){return`<p>I'm a child component I have inherited my parent's property a: ${this.a1}</p>`},templateBForComponentB:function(){return`<p>I'm a child component. This is my property B1: ${this.b1}</p>`},templateForChildComponentPlaceholder:function(){return'<my-child-component data-a1="a"></my-child-component>'}};const s={name:"componentOne",data:()=>({a:5,c:"Hello there!!",e:{f:5,g:6}}),computed:{b:function(){return 10*this.a},d:function(){return this.b+11},nestedComputed:function(){return isNaN(this.e.f)||isNaN(this.e.g)?0:this.e.f*this.e.g}},el:"appRoot",templates:[{html:m.templateForA,id:"a",prop:"a"},{html:m.templateForB,id:"b",prop:"b"},{html:m.templateForC,id:"c",prop:"c"},{html:m.templateForD,id:"d",prop:"d"},{html:m.templateForF,id:"f",prop:"e.f"},{html:m.templateForG,id:"g",prop:"e.g"},{html:m.templateForH,id:"h",prop:"nestedComputed"}],components:[{name:"my-child-component",value:{name:"childComponent",props:["a1"],data:()=>({b1:10}),templates:[{html:m.templateAForComponentB,id:"child_a",prop:"a1"},{html:m.templateBForComponentB,id:"child_b",prop:"b1"}]},template:m.templateForChildComponentPlaceholder}]};document.getElementById("inputA").onchange=function(t){let e=document.getElementById("inputA").value;isNaN(e)||(d.a=e)},document.getElementById("inputC").onchange=function(t){let e=document.getElementById("inputC").value;d.c=e},document.getElementById("inputF").onchange=function(t){let e=document.getElementById("inputF").value;d.e.f=e},document.getElementById("inputG").onchange=function(t){let e=document.getElementById("inputG").value;d.e.g=e};let d=u(s);console.log(d),setTimeout(()=>{d.c="hello Chicago!!"},2e3)}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9SZWFjdGl2aXR5L3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL1JlYWN0aXZpdHkvLi9nbG9iYWxzLmpzIiwid2VicGFjazovL1JlYWN0aXZpdHkvLi9yZWFjdGl2ZS9kZXAuanMiLCJ3ZWJwYWNrOi8vUmVhY3Rpdml0eS8uL3JlYWN0aXZlL3dhdGNoZXIuanMiLCJ3ZWJwYWNrOi8vUmVhY3Rpdml0eS8uL3JlYWN0aXZlL2JpbmRQcm9wLmpzIiwid2VicGFjazovL1JlYWN0aXZpdHkvLi91dGlscy5qcyIsIndlYnBhY2s6Ly9SZWFjdGl2aXR5Ly4vcmVuZGVyLmpzIiwid2VicGFjazovL1JlYWN0aXZpdHkvLi9yZWFjdGl2ZS9vYnNlcnZlci5qcyIsIndlYnBhY2s6Ly9SZWFjdGl2aXR5Ly4vdGVtcGxhdGVzLmpzIiwid2VicGFjazovL1JlYWN0aXZpdHkvLi9jb21wb25lbnRzLmpzIiwid2VicGFjazovL1JlYWN0aXZpdHkvLi90ZXN0LmpzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJjb25maWd1cmFibGUiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsInZhbHVlIiwibiIsIl9fZXNNb2R1bGUiLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJnbG9iYWxXYXRjaGVyQ291bnQiLCJnbG9iYWxEZXBUcmFja2VyQ291bnQiLCJEZXAiLCJ0aGlzIiwic3Vic2NyaWJlcnMiLCJkZXBlbmQiLCJ1bmRlZmluZWQiLCJmaW5kIiwidiIsImlkIiwicHVzaCIsIm5vdGlmeSIsImZvckVhY2giLCJjb25zb2xlIiwibG9nIiwidXBkYXRlIiwidGFyZ2V0IiwiV2F0Y2hlciIsImNiIiwidm0iLCJhcmdzIiwiYXBwbHkiLCJiaW5kUHJvcFRvVGVtcGxhdGUiLCJ0ZW1wbGF0ZSIsInByb3AiLCJyZW5kZXIiLCJpbmRleE9mIiwicHJvcHMiLCJfcHJvcHMiLCJzcGxpdCIsImxlbmd0aCIsInRyYXZlcnNlVG9Qcm9wIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImlubmVySFRNTCIsImluaXREYXRhIiwib2JqIiwicmVhY3RpdmUiLCJuZXN0ZWQiLCJ3cmFwcGVyIiwidmFsIiwiZGVwIiwic2V0IiwibmV3VmFsIiwibWFrZVJlYWN0aXZlIiwicHJvcFZhbHVlSGFzaCIsInBhcmVudCIsImNvbXB1dGVkIiwidGVtcGxhdGVzIiwiY29tcG9uZW50cyIsImRhdGEiLCJjb21wdXRlZFdhdGNoZXJzIiwiY29tcHV0ZWREZXBzIiwiaW5pdENvbXB1dGVkIiwiaW5pdFByb3BzIiwiaHRtbCIsImluaXRUZW1wbGF0ZXMiLCJjb21wb25lbnQiLCJ3YXJuIiwiYXR0cnMiLCJhdHRyIiwia3ZwIiwiSlNPTiIsInN0cmluZ2lmeSIsImluaXRDb21wb25lbnRzIiwidGVtcGxhdGVzXzAiLCJ0ZW1wbGF0ZUZvckEiLCJhIiwidGVtcGxhdGVGb3JCIiwiYiIsInRlbXBsYXRlRm9yQyIsInRlbXBsYXRlRm9yRCIsInRlbXBsYXRlRm9yRiIsImUiLCJmIiwidGVtcGxhdGVGb3JHIiwiZyIsInRlbXBsYXRlRm9ySCIsIm5lc3RlZENvbXB1dGVkIiwidGVtcGxhdGVBRm9yQ29tcG9uZW50QiIsImExIiwidGVtcGxhdGVCRm9yQ29tcG9uZW50QiIsImIxIiwidGVtcGxhdGVGb3JDaGlsZENvbXBvbmVudFBsYWNlaG9sZGVyIiwiY29tcG9uZW50T25lIiwiaXNOYU4iLCJlbCIsIm9uY2hhbmdlIiwibXlGaXJzdFJlYWN0aXZlQ29tcG9uZW50Iiwic2V0VGltZW91dCJdLCJtYXBwaW5ncyI6IjJCQUNBLElBQUFBLEtBR0EsU0FBQUMsRUFBQUMsR0FHQSxHQUFBRixF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ZCxHQUNBLElBQUFqQyxFQUFBUixTQUFBQyxlQUFBLFVBQUExQyxNQUNBOEYsTUFBQTdDLEtBQ0FnRCxFQUFBckIsRUFBQTNCLElBU0FSLFNBQUFDLGVBQUEsVUFBQXNELFNBSkEsU0FBQWQsR0FDQSxJQUFBakMsRUFBQVIsU0FBQUMsZUFBQSxVQUFBMUMsTUFDQWlHLEVBQUE1RyxFQUFBNEQsR0FRQVIsU0FBQUMsZUFBQSxVQUFBc0QsU0FKQSxTQUFBZCxHQUNBLElBQUFqQyxFQUFBUixTQUFBQyxlQUFBLFVBQUExQyxNQUNBaUcsRUFBQWYsRUFBQUMsRUFBQWxDLEdBUUFSLFNBQUFDLGVBQUEsVUFBQXNELFNBSkEsU0FBQWQsR0FDQSxJQUFBakMsRUFBQVIsU0FBQUMsZUFBQSxVQUFBMUMsTUFDQWlHLEVBQUFmLEVBQUFHLEVBQUFwQyxHQUlBLElBQUFnRCxFQUFBNUMsRUFBQXdDLEdBQ0F2RSxRQUFBQyxJQUFBMEUsR0FDQUMsV0FBQSxLQUNBRCxFQUFBNUcsRUFBQSxtQkFDQyIsImZpbGUiOiJidW5kbGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHtcbiBcdFx0XHRcdGNvbmZpZ3VyYWJsZTogZmFsc2UsXG4gXHRcdFx0XHRlbnVtZXJhYmxlOiB0cnVlLFxuIFx0XHRcdFx0Z2V0OiBnZXR0ZXJcbiBcdFx0XHR9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCIvXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAwKTtcbiIsIi8vR2xvYmFsIHZhcmlhYmxlc1xyXG5sZXQgZ2xvYmFsV2F0Y2hlckNvdW50ID0gMFxyXG5sZXQgZ2xvYmFsRGVwVHJhY2tlckNvdW50ID0gMFxyXG5leHBvcnQge2dsb2JhbFdhdGNoZXJDb3VudCwgZ2xvYmFsRGVwVHJhY2tlckNvdW50fSIsIiBpbXBvcnQge2dsb2JhbERlcFRyYWNrZXJDb3VudH0gZnJvbSAnLi4vZ2xvYmFscy5qcydcclxuIC8vRGVwZW5kZW5jeSBUcmFja2VyLCBtYWludGFpbnMgYSBsaXN0IG9mIHN1YnNjcmliZXJzLCBhbmQgYW4gYWN0aXZlIHRhcmdldCAoY2FuIG9ubHkgYmUgb25lIGF0IGFueSBwb2ludCBpbiB0aW1lKVxyXG5jb25zdCBEZXAgPSBmdW5jdGlvbihuYW1lKSB7XHJcbiAgdGhpcy5zdWJzY3JpYmVycyA9IFtdXHJcbiAgdGhpcy5kZXBlbmQgPSBmdW5jdGlvbihzKSB7XHJcbiAgICBpZiAodGhpcy5zdWJzY3JpYmVycy5maW5kKHYgPT4gdi5pZCA9PT0gcy5pZCkgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICB0aGlzLnN1YnNjcmliZXJzLnB1c2gocylcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIC8vIGNvbnNvbGUubG9nKHMuaWQgKyAnIGhhcyBhbHJlYWR5IHN1YnNjcmliZWQgZm9yICcgKyB0aGlzLmlkKVxyXG4gICAgfVxyXG4gIH1cclxuICB0aGlzLm5vdGlmeSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgdGhpcy5zdWJzY3JpYmVycy5mb3JFYWNoKChzKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKHRoaXMubmFtZSArICcgbm90aWZ5aW5nICcgKyBzLm5hbWUpXHJcbiAgICAgIHMudXBkYXRlKClcclxuICAgIH0pXHJcbiAgfVxyXG4gIHRoaXMuaWQgPSBnbG9iYWxEZXBUcmFja2VyQ291bnQrK1xyXG4gIHRoaXMubmFtZSA9IG5hbWVcclxufVxyXG5EZXAudGFyZ2V0ID0gbnVsbFxyXG5leHBvcnQge0RlcH1cclxuIiwiaW1wb3J0IHtnbG9iYWxXYXRjaGVyQ291bnR9IGZyb20gJy4uL2dsb2JhbHMuanMnXHJcbi8vV2F0Y2hlciAtIGF0dGFjaGVzIGFzIGFuIGFjdGl2ZSBkZXAgdGFyZ2V0LCBmaXJlcyB0aGUgdXBkYXRlIGNhbGxiYWNrXHJcbmV4cG9ydCBjb25zdCBXYXRjaGVyID0gZnVuY3Rpb24obmFtZSwgY2IsIHZtLCAuLi5hcmdzKSB7XHJcbiAgICB0aGlzLnVwZGF0ZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICBjYi5hcHBseSh2bSwgYXJncylcclxuICAgIH1cclxuICAgIHRoaXMuaWQgPSBnbG9iYWxXYXRjaGVyQ291bnQrK1xyXG4gICAgdGhpcy5uYW1lID0gbmFtZVxyXG59IiwiICBpbXBvcnQge0RlcH0gZnJvbSAnLi9kZXAuanMnXHJcbiAgaW1wb3J0IHtXYXRjaGVyfSBmcm9tICcuL3dhdGNoZXIuanMnXHJcbiAgaW1wb3J0IHt0cmF2ZXJzZVRvUHJvcH0gZnJvbSAnLi4vdXRpbHMuanMnXHJcblxyXG4gIC8vRm4gdG8gYmluZCBjb21wb25lbnQncyBwcm9wcyB0byBodG1sIHRlbXBsYXRlXHJcbiAgZXhwb3J0IGNvbnN0IGJpbmRQcm9wVG9UZW1wbGF0ZSA9IGZ1bmN0aW9uKHRlbXBsYXRlLCBpZCwgcHJvcCkge1xyXG4gICAgY29uc29sZS5sb2coXCJiaW5kUHJvcFRvVGVtcGxhdGU6XCIgKyBpZCArIFwiOlwiICsgdGhpc1twcm9wXSlcclxuICAgIERlcC50YXJnZXQgPSBuZXcgV2F0Y2hlcignQmluZGluZyBwcm9wIFdhdGNoZXI6ICcgKyBpZCwgdGhpcy5yZW5kZXIsIHRoaXMsIHRlbXBsYXRlLCBpZClcclxuICAgIGxldCB2YWwgPSB0eXBlb2YodGhpc1twcm9wXSkgPT09IFwiZnVuY3Rpb25cIiA/IHRoaXNbcHJvcF0uYXBwbHkodGhpcykgOiBwcm9wLmluZGV4T2YoJy4nKSAhPT0gLTEgPyB0cmF2ZXJzZVRvUHJvcCh0aGlzLCBwcm9wKSA6IHRoaXNbcHJvcF1cclxuICAgIERlcC50YXJnZXQgPSBudWxsXHJcbiAgfSIsIi8vVHJhdmVyc2UgdG8gdGhlIG5lc3RlZCBwcm9wXHJcbmNvbnN0IHRyYXZlcnNlVG9Qcm9wID0gKHRhcmdldCwgcHJvcHMpID0+IHtcclxuICAgIGxldCBfcHJvcHMgPSBwcm9wcy5zcGxpdCgnLicpXHJcbiAgICBjb25zb2xlLmxvZyhfcHJvcHMpXHJcbiAgICBsZXQgdmFsID0ge31cclxuICAgIGxldCBvID0gdGFyZ2V0W19wcm9wc1swXV1cclxuICAgIGZvciAobGV0IGkgPSAxOyBpIDwgX3Byb3BzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIG8gPSBvW19wcm9wc1tpXV1cclxuICAgIH1cclxuICAgIHJldHVybiBvXHJcbiAgfVxyXG4gIFxyXG4gIGV4cG9ydCB7dHJhdmVyc2VUb1Byb3B9XHJcbiBcclxuICAiLCIgIC8vb25seSB0aGlzIGd1eSBzaG91bGQgdG91Y2ggdGhlIERPTSwga2lkZGluZyBub3RcclxuICBleHBvcnQgY29uc3QgcmVuZGVyID0gZnVuY3Rpb24odGVtcGxhdGUsIGlkKSB7XHJcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCkuaW5uZXJIVE1MID0gdGVtcGxhdGUuYXBwbHkodGhpcylcclxuICB9IiwiXHJcbmltcG9ydCB7IERlcCB9IGZyb20gJy4vZGVwLmpzJ1xyXG5pbXBvcnQgeyBXYXRjaGVyIH0gZnJvbSAnLi93YXRjaGVyLmpzJ1xyXG5pbXBvcnQgeyBiaW5kUHJvcFRvVGVtcGxhdGUgfSBmcm9tICcuL2JpbmRQcm9wLmpzJ1xyXG5pbXBvcnQgeyByZW5kZXIgfSBmcm9tICcuLi9yZW5kZXIuanMnXHJcblxyXG5jb25zdCBpbml0RGF0YSA9IGZ1bmN0aW9uIChvYmosIHJlYWN0aXZlLCBuZXN0ZWQpIHtcclxuICBpZiAodHlwZW9mIG9iaiAhPT0gJ29iamVjdCcpIHtcclxuICAgIHJldHVybiBvYmpcclxuICB9XHJcbiAgbGV0IHdyYXBwZXIgPSB7fVxyXG5cclxuICBmb3IgKGxldCBwcm9wIGluIG9iaikge1xyXG4gICAgbGV0IHZhbCA9IG9ialtwcm9wXVxyXG4gICAgaWYgKHR5cGVvZiBvYmpbcHJvcF0gPT09IFwib2JqZWN0XCIpIHtcclxuICAgICAgdmFsID0gaW5pdERhdGEob2JqW3Byb3BdLCByZWFjdGl2ZSwgdHJ1ZSlcclxuICAgIH1cclxuICAgIGxldCBkZXAgPSBuZXcgRGVwKHByb3ApXHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobmVzdGVkID8gd3JhcHBlciA6IHJlYWN0aXZlLCBwcm9wLCB7XHJcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmIChEZXAudGFyZ2V0KSB7XHJcbiAgICAgICAgICBkZXAuZGVwZW5kKERlcC50YXJnZXQpXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB2YWxcclxuICAgICAgfSxcclxuICAgICAgc2V0OiBmdW5jdGlvbiAobmV3VmFsKSB7XHJcbiAgICAgICAgdmFsID0gaW5pdERhdGEobmV3VmFsLCByZWFjdGl2ZSlcclxuICAgICAgICBkZXAubm90aWZ5KClcclxuICAgICAgfVxyXG4gICAgfSlcclxuICB9XHJcbiAgcmV0dXJuIG5lc3RlZCA/IHdyYXBwZXIgOiByZWFjdGl2ZVxyXG59XHJcblxyXG5jb25zdCBtYWtlUmVhY3RpdmUgPSBmdW5jdGlvbiAodm0sIHByb3BWYWx1ZUhhc2gsIHBhcmVudCkge1xyXG4gIGxldCByZWFjdGl2ZSA9IHt9XHJcbiAgcmVhY3RpdmUucmVuZGVyID0gcmVuZGVyXHJcbiAgcmVhY3RpdmUuYmluZFByb3BUb1RlbXBsYXRlID0gYmluZFByb3BUb1RlbXBsYXRlXHJcbiAgY29uc3QgY29tcHV0ZWQgPSB2bS5jb21wdXRlZFxyXG4gIGNvbnN0IHRlbXBsYXRlcyA9IHZtLnRlbXBsYXRlc1xyXG4gIGNvbnN0IHByb3BzID0gdm0ucHJvcHMgfHwgW11cclxuICBjb25zdCBjb21wb25lbnRzID0gdm0uY29tcG9uZW50cyB8fCBbXVxyXG4gIGNvbnN0IGRhdGEgPSAodm0uZGF0YSAmJiB2bS5kYXRhKCkpIHx8IHt9XHJcblxyXG4gIGluaXREYXRhKGRhdGEsIHJlYWN0aXZlKVxyXG5cclxuICBpbml0Q29tcHV0ZWQocmVhY3RpdmUsIGNvbXB1dGVkKVxyXG5cclxuICBpbml0UHJvcHMocmVhY3RpdmUsIHByb3BzLCBwcm9wVmFsdWVIYXNoLCBwYXJlbnQpXHJcblxyXG4gIGluaXRUZW1wbGF0ZXMocmVhY3RpdmUsIHRlbXBsYXRlcylcclxuICBcclxuICBpbml0Q29tcG9uZW50cyhyZWFjdGl2ZSwgY29tcG9uZW50cylcclxuICBcclxuICByZXR1cm4gcmVhY3RpdmVcclxufVxyXG5cclxuZnVuY3Rpb24gaW5pdENvbXB1dGVkKHJlYWN0aXZlLCBjb21wdXRlZCkge1xyXG4gIGxldCBjb21wdXRlZFdhdGNoZXJzID0ge31cclxuICBsZXQgY29tcHV0ZWREZXBzID0ge31cclxuICAvL0NvbXB1dGVkIHByb3BlcnRpZXMgZ2V0cyB0aGVpciBvd24gd2F0Y2hlcnMhIFxyXG4gIGZvciAobGV0IHByb3AgaW4gY29tcHV0ZWQpIHtcclxuICAgIGNvbXB1dGVkV2F0Y2hlcnNbcHJvcF0gPSBuZXcgV2F0Y2hlcignQ29tcHV0ZWQgd2F0Y2hlciBwcm9wOiAnICsgcHJvcCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICBjb21wdXRlZERlcHNbcHJvcF0ubm90aWZ5KClcclxuICAgIH0sIG51bGwpXHJcbiAgfVxyXG4gIC8vUmVhY3RpdmUgY29tcHV0ZWQgcHJvcHNcclxuICBmb3IgKGxldCBwcm9wIGluIGNvbXB1dGVkKSB7XHJcbiAgICBjb21wdXRlZERlcHNbcHJvcF0gPSBuZXcgRGVwKHByb3ApXHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkocmVhY3RpdmUsIHByb3AsIHtcclxuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKERlcC50YXJnZXQpIHtcclxuICAgICAgICAgIGNvbXB1dGVkRGVwc1twcm9wXS5kZXBlbmQoRGVwLnRhcmdldClcclxuICAgICAgICAgIERlcC50YXJnZXQgPSBudWxsXHJcbiAgICAgICAgfVxyXG4gICAgICAgIERlcC50YXJnZXQgPSBjb21wdXRlZFdhdGNoZXJzW3Byb3BdXHJcbiAgICAgICAgbGV0IHZhbCA9IGNvbXB1dGVkW3Byb3BdLmFwcGx5KHRoaXMpXHJcbiAgICAgICAgRGVwLnRhcmdldCA9IG51bGxcclxuICAgICAgICByZXR1cm4gdmFsXHJcbiAgICAgIH1cclxuICAgIH0pXHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBpbml0UHJvcHMocmVhY3RpdmUsIHByb3BzLCBwcm9wVmFsdWVIYXNoLCBwYXJlbnQpIHtcclxuICBmb3IgKGxldCBwcm9wIG9mIHByb3BzKSB7XHJcbiAgICBsZXQgZGVwID0gbmV3IERlcChwcm9wKVxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHJlYWN0aXZlLCBwcm9wLCB7XHJcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmIChEZXAudGFyZ2V0KSB7XHJcbiAgICAgICAgICBkZXAuZGVwZW5kKERlcC50YXJnZXQpXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBwYXJlbnRbcHJvcFZhbHVlSGFzaFtwcm9wXV1cclxuICAgICAgfVxyXG4gICAgfSlcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGluaXRUZW1wbGF0ZXMocmVhY3RpdmUsIHRlbXBsYXRlcykge1xyXG4gIGZvciAobGV0IHRlbXBsYXRlIG9mIHRlbXBsYXRlcykge1xyXG4gICAgcmVhY3RpdmUuYmluZFByb3BUb1RlbXBsYXRlKHRlbXBsYXRlLmh0bWwsIHRlbXBsYXRlLmlkLCB0ZW1wbGF0ZS5wcm9wKVxyXG4gICAgcmVhY3RpdmUucmVuZGVyKHRlbXBsYXRlLmh0bWwsIHRlbXBsYXRlLmlkKVxyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gaW5pdENvbXBvbmVudHMocmVhY3RpdmUsIGNvbXBvbmVudHMpIHtcclxuICBmb3IgKGxldCBjb21wb25lbnQgb2YgY29tcG9uZW50cykge1xyXG4gICAgbGV0IHRlbXBsYXRlID0gY29tcG9uZW50LnRlbXBsYXRlKClcclxuICAgIGxldCBuYW1lID0gY29tcG9uZW50Lm5hbWVcclxuICAgIGxldCB2YWx1ZSA9IGNvbXBvbmVudC52YWx1ZVxyXG4gICAgbGV0IGNoaWxkVGVtcGxhdGVzID0gdmFsdWUudGVtcGxhdGVzXHJcbiAgICBpZiAodGVtcGxhdGUuaW5kZXhPZihuYW1lKSA9PT0gLTEpIHtcclxuICAgICAgY29uc29sZS53YXJuKGAke25hbWV9IG5vdCBkZWZpbmVkIGluIHRoZSB0ZW1wbGF0ZWApXHJcbiAgICAgIGJyZWFrXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBsZXQgYXR0cnMgPSB0ZW1wbGF0ZS5zcGxpdCgnPC8nICsgbmFtZSArICc+JylbMF0uc3BsaXQoJ2RhdGEtJylcclxuICAgICAgbGV0IHByb3BWYWx1ZUhhc2ggPSB7fVxyXG4gICAgICBmb3IgKGxldCBhdHRyIG9mIGF0dHJzKSB7XHJcbiAgICAgICAgaWYgKGF0dHIuaW5kZXhPZignPScpICE9PSAtMSkge1xyXG4gICAgICAgICAgbGV0IGt2cCA9IGF0dHIuc3BsaXQoJz0nKVxyXG4gICAgICAgICAgcHJvcFZhbHVlSGFzaFtrdnBbMF1dID0ga3ZwWzFdLnNwbGl0KCdcIicpWzFdXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGNvbnNvbGUubG9nKCdwcm9wVmFsdWVIYXNoOicgKyBKU09OLnN0cmluZ2lmeShwcm9wVmFsdWVIYXNoKSlcclxuICAgICAgbWFrZVJlYWN0aXZlKHZhbHVlLCBwcm9wVmFsdWVIYXNoLCByZWFjdGl2ZSlcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCB7IG1ha2VSZWFjdGl2ZSB9XHJcblxyXG4iLCJcclxubGV0IHRlbXBsYXRlRm9yQSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgcmV0dXJuIGA8cD5IZWxsbywgSSBhbSBhIDxpPmRhdGE8L2k+IHByb3AuIFlvdSBjYW4gY2FsbCBtZSA8c3Ryb25nPkE8L3N0cm9uZz46ICR7dGhpcy5hfTwvcD5gXHJcbiAgfVxyXG4gIFxyXG4gIGxldCB0ZW1wbGF0ZUZvckIgPSBmdW5jdGlvbigpIHtcclxuICAgIHJldHVybiBgPHA+SGVsbG8sIEkgYW0gYSA8aT5jb21wdXRlZDwvaT4gcHJvcC4gWW91IGNhbiBjYWxsIG1lIDxzdHJvbmc+Qjwvc3Ryb25nPiAoQSAqIDEwKTogJHt0aGlzLmJ9PC9wPmBcclxuICB9XHJcbiAgXHJcbiAgbGV0IHRlbXBsYXRlRm9yQyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgcmV0dXJuIGA8cD5IZWxsbywgSSBhbSBhIDxpPmRhdGE8L2k+IHByb3AuIFlvdSBjYW4gY2FsbCBtZSA8c3Ryb25nPkM8L3N0cm9uZz46ICR7dGhpcy5jfTwvcD5gXHJcbiAgfVxyXG4gIFxyXG4gIGxldCB0ZW1wbGF0ZUZvckQgPSBmdW5jdGlvbigpIHtcclxuICAgIHJldHVybiBgPHA+SGVsbG8sIEkgYW0gYSA8aT5jb21wdXRlZDwvaT4gcHJvcC4gWW91IGNhbiBjYWxsIG1lIDxzdHJvbmc+RDwvc3Ryb25nPiAoQiArIDExKTogJHt0aGlzLmR9PC9wPmBcclxuICB9XHJcbiAgXHJcbiAgXHJcbiAgbGV0IHRlbXBsYXRlRm9yRiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgcmV0dXJuIGA8cD5IZWxsbywgSSBhbSBhIDxpPm5lc3RlZCBkYXRhPC9pPiBwcm9wLiBZb3UgY2FuIGNhbGwgbWUgPHN0cm9uZz5GPC9zdHJvbmc+KExlbmd0aCk6ICR7dGhpcy5lLmZ9PC9wPmBcclxuICB9XHJcbiAgXHJcbiAgbGV0IHRlbXBsYXRlRm9yRyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgcmV0dXJuIGA8cD5IZWxsbywgSSBhbSBhIDxpPm5lc3RlZCBkYXRhPC9pPiBwcm9wLiBZb3UgY2FuIGNhbGwgbWUgPHN0cm9uZz5HPC9zdHJvbmc+KFdpZHRoKTogJHt0aGlzLmUuZ308L3A+YFxyXG4gIH1cclxuICBcclxuICBcclxuICBsZXQgdGVtcGxhdGVGb3JIID0gZnVuY3Rpb24oKSB7XHJcbiAgICByZXR1cm4gYDxwPkhlbGxvLCBJIGFtIGEgPGk+bmVzdGVkIGNvbXB1dGVkPC9pPiBwcm9wLiBZb3UgY2FuIGNhbGwgbWUgPHN0cm9uZz5IPC9zdHJvbmc+KEFyZWEpOiAke3RoaXMubmVzdGVkQ29tcHV0ZWR9PC9wPmBcclxuICB9XHJcbiAgXHJcbiAgbGV0IHRlbXBsYXRlQUZvckNvbXBvbmVudEIgPSBmdW5jdGlvbigpIHtcclxuICAgIHJldHVybiBgPHA+SSdtIGEgY2hpbGQgY29tcG9uZW50IEkgaGF2ZSBpbmhlcml0ZWQgbXkgcGFyZW50J3MgcHJvcGVydHkgYTogJHt0aGlzLmExfTwvcD5gXHJcbiAgfVxyXG4gIFxyXG4gIGxldCB0ZW1wbGF0ZUJGb3JDb21wb25lbnRCID0gZnVuY3Rpb24oKSB7XHJcbiAgICByZXR1cm4gYDxwPkknbSBhIGNoaWxkIGNvbXBvbmVudC4gVGhpcyBpcyBteSBwcm9wZXJ0eSBCMTogJHt0aGlzLmIxfTwvcD5gXHJcbiAgfVxyXG4gIFxyXG4gIGxldCB0ZW1wbGF0ZUZvckNoaWxkQ29tcG9uZW50UGxhY2Vob2xkZXIgPSBmdW5jdGlvbigpIHtcclxuICAgIHJldHVybiBgPG15LWNoaWxkLWNvbXBvbmVudCBkYXRhLWExPVwiYVwiPjwvbXktY2hpbGQtY29tcG9uZW50PmBcclxuICB9XHJcblxyXG4gIGV4cG9ydCBkZWZhdWx0IHtcclxuICAgICAgdGVtcGxhdGVGb3JBLFxyXG4gICAgICB0ZW1wbGF0ZUZvckIsXHJcbiAgICAgIHRlbXBsYXRlRm9yQyxcclxuICAgICAgdGVtcGxhdGVGb3JELFxyXG4gICAgICB0ZW1wbGF0ZUZvckYsXHJcbiAgICAgIHRlbXBsYXRlRm9yRyxcclxuICAgICAgdGVtcGxhdGVGb3JILFxyXG4gICAgICB0ZW1wbGF0ZUFGb3JDb21wb25lbnRCLFxyXG4gICAgICB0ZW1wbGF0ZUJGb3JDb21wb25lbnRCLFxyXG4gICAgICB0ZW1wbGF0ZUZvckNoaWxkQ29tcG9uZW50UGxhY2Vob2xkZXJcclxuICB9IiwiLy9Db21wb25lbnQgRGVmaW5pdGlvbnNcclxuaW1wb3J0IHRlbXAgZnJvbSAnLi90ZW1wbGF0ZXMuanMnXHJcbmNvbnN0IGNoaWxkQ29tcG9uZW50ID0ge1xyXG4gICAgbmFtZTogJ2NoaWxkQ29tcG9uZW50JyxcclxuICAgIHByb3BzOiBbJ2ExJ10sXHJcbiAgICBkYXRhKCkge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGIxOiAxMFxyXG4gICAgICB9XHJcbiAgICB9LFxyXG4gICAgdGVtcGxhdGVzOiBbe1xyXG4gICAgICAgIGh0bWw6IHRlbXAudGVtcGxhdGVBRm9yQ29tcG9uZW50QixcclxuICAgICAgICBpZDogXCJjaGlsZF9hXCIsXHJcbiAgICAgICAgcHJvcDogXCJhMVwiXHJcbiAgICAgIH0sXHJcbiAgICAgIHtcclxuICAgICAgICBodG1sOiB0ZW1wLnRlbXBsYXRlQkZvckNvbXBvbmVudEIsXHJcbiAgICAgICAgaWQ6IFwiY2hpbGRfYlwiLFxyXG4gICAgICAgIHByb3A6IFwiYjFcIlxyXG4gICAgICB9XHJcbiAgICBdXHJcbiAgfVxyXG4gIFxyXG4gIGNvbnN0IGNvbXBvbmVudE9uZSA9IHtcclxuICAgIG5hbWU6ICdjb21wb25lbnRPbmUnLFxyXG4gICAgZGF0YSgpIHtcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBhOiA1LFxyXG4gICAgICAgIGM6ICdIZWxsbyB0aGVyZSEhJyxcclxuICAgICAgICBlOiB7XHJcbiAgICAgICAgICBmOiA1LFxyXG4gICAgICAgICAgZzogNlxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSxcclxuICAgIGNvbXB1dGVkOiB7XHJcbiAgICAgIGI6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmEgKiAxMFxyXG4gICAgICB9LFxyXG4gICAgICBkOiBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5iICsgMTFcclxuICAgICAgfSxcclxuICAgICAgbmVzdGVkQ29tcHV0ZWQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmIChpc05hTih0aGlzLmUuZikgfHwgaXNOYU4odGhpcy5lLmcpKSB7XHJcbiAgICAgICAgICByZXR1cm4gMFxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5lLmYgKiB0aGlzLmUuZ1xyXG4gICAgICB9XHJcbiAgICB9LFxyXG4gICAgZWw6ICdhcHBSb290JyxcclxuICAgIHRlbXBsYXRlczogW3tcclxuICAgICAgICBodG1sOiB0ZW1wLnRlbXBsYXRlRm9yQSxcclxuICAgICAgICBpZDogXCJhXCIsXHJcbiAgICAgICAgcHJvcDogXCJhXCJcclxuICAgICAgfSxcclxuICAgICAge1xyXG4gICAgICAgIGh0bWw6IHRlbXAudGVtcGxhdGVGb3JCLFxyXG4gICAgICAgIGlkOiBcImJcIixcclxuICAgICAgICBwcm9wOiBcImJcIlxyXG4gICAgICB9LFxyXG4gICAgICB7XHJcbiAgICAgICAgaHRtbDogdGVtcC50ZW1wbGF0ZUZvckMsXHJcbiAgICAgICAgaWQ6IFwiY1wiLFxyXG4gICAgICAgIHByb3A6IFwiY1wiXHJcbiAgICAgIH0sXHJcbiAgICAgIHtcclxuICAgICAgICBodG1sOiB0ZW1wLnRlbXBsYXRlRm9yRCxcclxuICAgICAgICBpZDogXCJkXCIsXHJcbiAgICAgICAgcHJvcDogXCJkXCJcclxuICAgICAgfSxcclxuICAgICAge1xyXG4gICAgICAgIGh0bWw6IHRlbXAudGVtcGxhdGVGb3JGLFxyXG4gICAgICAgIGlkOiBcImZcIixcclxuICAgICAgICBwcm9wOiBcImUuZlwiXHJcbiAgICAgIH0sXHJcbiAgICAgIHtcclxuICAgICAgICBodG1sOiB0ZW1wLnRlbXBsYXRlRm9yRyxcclxuICAgICAgICBpZDogXCJnXCIsXHJcbiAgICAgICAgcHJvcDogXCJlLmdcIlxyXG4gICAgICB9LFxyXG4gICAgICB7XHJcbiAgICAgICAgaHRtbDogdGVtcC50ZW1wbGF0ZUZvckgsXHJcbiAgICAgICAgaWQ6IFwiaFwiLFxyXG4gICAgICAgIHByb3A6IFwibmVzdGVkQ29tcHV0ZWRcIlxyXG4gICAgICB9XHJcbiAgICBdLFxyXG4gICAgY29tcG9uZW50czogW3tcclxuICAgICAgbmFtZTogJ215LWNoaWxkLWNvbXBvbmVudCcsXHJcbiAgICAgIHZhbHVlOiBjaGlsZENvbXBvbmVudCxcclxuICAgICAgdGVtcGxhdGU6IHRlbXAudGVtcGxhdGVGb3JDaGlsZENvbXBvbmVudFBsYWNlaG9sZGVyXHJcbiAgICB9XVxyXG4gIH1cclxuXHJcbiAgZXhwb3J0IHtjaGlsZENvbXBvbmVudCwgY29tcG9uZW50T25lfSIsImltcG9ydCB7bWFrZVJlYWN0aXZlfSBmcm9tICcuL3JlYWN0aXZlL29ic2VydmVyLmpzJ1xyXG5pbXBvcnQge2NvbXBvbmVudE9uZX0gZnJvbSAnLi9jb21wb25lbnRzLmpzJ1xyXG4vL0V2ZW50IGhhbmRsZXIgZm9yIGlucHV0IGNoYW5nZXNcclxuZnVuY3Rpb24gc2V0VmFsRm9yQShlKSB7XHJcbiAgICBsZXQgdmFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2lucHV0QScpLnZhbHVlO1xyXG4gICAgaWYgKCFpc05hTih2YWwpKSB7XHJcbiAgICAgIG15Rmlyc3RSZWFjdGl2ZUNvbXBvbmVudC5hID0gdmFsXHJcbiAgICB9XHJcbiAgfVxyXG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbnB1dEEnKS5vbmNoYW5nZSA9IHNldFZhbEZvckFcclxuICBcclxuICBmdW5jdGlvbiBzZXRWYWxGb3JDKGUpIHtcclxuICAgIGxldCB2YWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW5wdXRDJykudmFsdWU7XHJcbiAgICBteUZpcnN0UmVhY3RpdmVDb21wb25lbnQuYyA9IHZhbFxyXG4gIH1cclxuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW5wdXRDJykub25jaGFuZ2UgPSBzZXRWYWxGb3JDXHJcbiAgXHJcbiAgZnVuY3Rpb24gc2V0VmFsRm9yRihlKSB7XHJcbiAgICBsZXQgdmFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2lucHV0RicpLnZhbHVlO1xyXG4gICAgbXlGaXJzdFJlYWN0aXZlQ29tcG9uZW50LmUuZiA9IHZhbFxyXG4gIH1cclxuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW5wdXRGJykub25jaGFuZ2UgPSBzZXRWYWxGb3JGXHJcbiAgXHJcbiAgZnVuY3Rpb24gc2V0VmFsRm9yRyhlKSB7XHJcbiAgICBsZXQgdmFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2lucHV0RycpLnZhbHVlO1xyXG4gICAgbXlGaXJzdFJlYWN0aXZlQ29tcG9uZW50LmUuZyA9IHZhbFxyXG4gIH1cclxuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2lucHV0RycpLm9uY2hhbmdlID0gc2V0VmFsRm9yR1xyXG5cclxubGV0IG15Rmlyc3RSZWFjdGl2ZUNvbXBvbmVudCA9IG1ha2VSZWFjdGl2ZShjb21wb25lbnRPbmUpXHJcbmNvbnNvbGUubG9nKG15Rmlyc3RSZWFjdGl2ZUNvbXBvbmVudClcclxuc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgbXlGaXJzdFJlYWN0aXZlQ29tcG9uZW50LmMgPSBcImhlbGxvIENoaWNhZ28hIVwiXHJcbn0sIDIwMDApXHJcblxyXG4iXSwic291cmNlUm9vdCI6IiJ9