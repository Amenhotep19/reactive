var Reactivity=function(t){var e={};function n(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:o})},n.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/",n(n.s=0)}([function(t,e,n){"use strict";n.r(e);let o=0,i=0;const r=function(t){this.subscribers=[],this.depend=function(t){void 0===this.subscribers.find(e=>e.id===t.id)&&this.subscribers.push(t)},this.notify=function(){this.subscribers.forEach(t=>{console.log(this.name+" notifying "+t.name),t.update()})},this.id=i++,this.name=t};r.target=null;const l=function(t,e,n,...i){this.update=function(){e.apply(n,i)},this.id=o++,this.name=t},p=function(t,e,n,o){console.log("bindPropToTemplate:"+e+":"+this[n]),r.target=new l("Binding prop Watcher: "+e,this.render,this,t,e,o);"function"==typeof this[n]?this[n].apply(this):-1!==n.indexOf(".")?((t,e)=>{let n=e.split(".");console.log(n);let o=t[n[0]];for(let t=1;t<n.length;t++)o=o[n[t]]})(this,n):this[n];r.target=null},a=function(t,e,n){let o=document.getElementById(e);if(o)o.innerHTML=t.apply(this),o.classList.add("activeProps"),setTimeout(()=>{o.classList.remove("activeProps")},3e3);else{let i=document.getElementById(n);(o=document.createElement("div")).id=e,o.innerHTML=t.apply(this),i.appendChild(o)}},c=function(t,e,n){if("object"!=typeof t)return t;let o={};for(let i in t){let l=t[i];"object"==typeof t[i]&&(l=c(t[i],e,!0));let p=new r(i);Object.defineProperty(n?o:e,i,{get:function(){return r.target&&p.depend(r.target),l},set:function(t){l=c(t,e),p.notify()}})}return n?o:e},u=function(t,e,n){const o=t.computed,i=t.templates,m=t.props||[],s=t.components||[],d=t.data&&t.data()||{};let f={};return f.render=a,f.bindPropToTemplate=p,f.name=t.name,f.el=t.el,c(d,f),function(t,e){let n={},o={};for(let i in e){let p=null;n[i]=new l("Computed watcher prop: "+i,function(){p=e[i].apply(t),o[i].notify()},null),r.target=n[i],p=e[i].apply(t),r.target=null,o[i]=new r(i),Object.defineProperty(t,i,{get:function(){return r.target&&(o[i].depend(r.target),r.target=null),p}})}}(f,o),function(t,e,n,o){for(let i of e){let e=new r(i);Object.defineProperty(t,i,{get:function(){return r.target&&e.depend(r.target),o[n[i]]}})}}(f,m,e,n),function(t,e){for(let n of e)t.bindPropToTemplate(n.html,n.id,n.prop),t.render(n.html,n.id,t.el)}(f,i),function(t,e){for(let n of e){let e=n.template(),o=n.name,i=n.value;i.templates;if(-1===e.indexOf(o)){console.warn(`${o} not defined in the template`);break}{let n=e.split("</"+o+">")[0].split("data-"),r={};for(let t of n)if(-1!==t.indexOf("=")){let e=t.split("=");r[e[0]]=e[1].split('"')[1]}console.log("propValueHash:"+JSON.stringify(r)),u(i,r,t)}}}(f,s),f};var m={templateForA:function(){return`<p>Hello, I am a <i>data</i> prop. You can call me <strong>A</strong>: ${this.a}</p>`},templateForB:function(){return`<p>Hello, I am a <i>computed</i> prop. You can call me <strong>B</strong> (A * 10): ${this.b}</p>`},templateForC:function(){return`<p>Hello, I am a <i>data</i> prop. You can call me <strong>C</strong>: ${this.c}</p>`},templateForD:function(){return`<p>Hello, I am a <i>computed</i> prop. You can call me <strong>D</strong> (B + 11): ${this.d}</p>`},templateForF:function(){return`<p>Hello, I am a <i>nested data</i> prop. You can call me <strong>F</strong>(Length): ${this.e.f}</p>`},templateForG:function(){return`<p>Hello, I am a <i>nested data</i> prop. You can call me <strong>G</strong>(Width): ${this.e.g}</p>`},templateForH:function(){return`<p>Hello, I am a <i>nested computed</i> prop. You can call me <strong>H</strong>(Area): ${this.nestedComputed}</p>`},templateAForComponentB:function(){return`<p>I'm a child component I have inherited my parent's property a: ${this.a1}</p>`},templateBForComponentB:function(){return`<p>I'm a child component. This is my property B1: ${this.b1}</p>`},templateForChildComponentPlaceholder:function(){return'<my-child-component data-a1="a"></my-child-component>'}};const s={name:"componentOne",data:()=>({a:5,c:"Hello there!!",e:{f:5,g:6}}),computed:{b:function(){return 10*this.a},d:function(){return this.b+11},nestedComputed:function(){return isNaN(this.e.f)||isNaN(this.e.g)?0:this.e.f*this.e.g}},el:"componentOne",templates:[{html:m.templateForA,id:"a",prop:"a"},{html:m.templateForB,id:"b",prop:"b"},{html:m.templateForC,id:"c",prop:"c"},{html:m.templateForD,id:"d",prop:"d"},{html:m.templateForF,id:"f",prop:"e.f"},{html:m.templateForG,id:"g",prop:"e.g"},{html:m.templateForH,id:"h",prop:"nestedComputed"}],components:[{name:"my-child-component",value:{name:"childComponent",el:"childComponent",props:["a1"],data:()=>({b1:10}),templates:[{html:m.templateAForComponentB,id:"child_a",prop:"a1"},{html:m.templateBForComponentB,id:"child_b",prop:"b1"}]},template:m.templateForChildComponentPlaceholder}]};document.getElementById("inputA").onchange=function(t){let e=document.getElementById("inputA").value;isNaN(e)||(d.a=e)},document.getElementById("inputC").onchange=function(t){let e=document.getElementById("inputC").value;d.c=e},document.getElementById("inputF").onchange=function(t){let e=document.getElementById("inputF").value;d.e.f=e},document.getElementById("inputG").onchange=function(t){let e=document.getElementById("inputG").value;d.e.g=e};let d=u(s);console.log(d),setTimeout(()=>{d.c="hello Chicago!!"},2e3)}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9SZWFjdGl2aXR5L3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL1JlYWN0aXZpdHkvLi9nbG9iYWxzLmpzIiwid2VicGFjazovL1JlYWN0aXZpdHkvLi9yZWFjdGl2ZS9kZXAuanMiLCJ3ZWJwYWNrOi8vUmVhY3Rpdml0eS8uL3JlYWN0aXZlL3dhdGNoZXIuanMiLCJ3ZWJwYWNrOi8vUmVhY3Rpdml0eS8uL3JlYWN0aXZlL2JpbmRQcm9wLmpzIiwid2VicGFjazovL1JlYWN0aXZpdHkvLi91dGlscy5qcyIsIndlYnBhY2s6Ly9SZWFjdGl2aXR5Ly4vcmVuZGVyLmpzIiwid2VicGFjazovL1JlYWN0aXZpdHkvLi9yZWFjdGl2ZS9vYnNlcnZlci5qcyIsIndlYnBhY2s6Ly9SZWFjdGl2aXR5Ly4vdGVtcGxhdGVzLmpzIiwid2VicGFjazovL1JlYWN0aXZpdHkvLi9jb21wb25lbnRzLmpzIiwid2VicGFjazovL1JlYWN0aXZpdHkvLi90ZXN0LmpzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJjb25maWd1cmFibGUiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsInZhbHVlIiwibiIsIl9fZXNNb2R1bGUiLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJnbG9iYWxXYXRjaGVyQ291bnQiLCJnbG9iYWxEZXBUcmFja2VyQ291bnQiLCJEZXAiLCJ0aGlzIiwic3Vic2NyaWJlcnMiLCJkZXBlbmQiLCJ1bmRlZmluZWQiLCJmaW5kIiwidiIsImlkIiwicHVzaCIsIm5vdGlmeSIsImZvckVhY2giLCJjb25zb2xlIiwibG9nIiwidXBkYXRlIiwidGFyZ2V0IiwiV2F0Y2hlciIsImNiIiwidm0iLCJhcmdzIiwiYXBwbHkiLCJiaW5kUHJvcFRvVGVtcGxhdGUiLCJ0ZW1wbGF0ZSIsInByb3AiLCJjb21wb25lbnRJZCIsInJlbmRlciIsImluZGV4T2YiLCJwcm9wcyIsIl9wcm9wcyIsInNwbGl0IiwibGVuZ3RoIiwidHJhdmVyc2VUb1Byb3AiLCJlbCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJpbm5lckhUTUwiLCJjbGFzc0xpc3QiLCJhZGQiLCJzZXRUaW1lb3V0IiwicmVtb3ZlIiwiY29tcG9uZW50Um9vdCIsImNyZWF0ZUVsZW1lbnQiLCJhcHBlbmRDaGlsZCIsImluaXREYXRhIiwib2JqIiwicmVhY3RpdmUiLCJuZXN0ZWQiLCJ3cmFwcGVyIiwidmFsIiwiZGVwIiwic2V0IiwibmV3VmFsIiwibWFrZVJlYWN0aXZlIiwicHJvcFZhbHVlSGFzaCIsInBhcmVudCIsImNvbXB1dGVkIiwidGVtcGxhdGVzIiwiY29tcG9uZW50cyIsImRhdGEiLCJjb21wdXRlZFdhdGNoZXJzIiwiY29tcHV0ZWREZXBzIiwiY2FjaGVkVmFsdWUiLCJpbml0Q29tcHV0ZWQiLCJpbml0UHJvcHMiLCJodG1sIiwiaW5pdFRlbXBsYXRlcyIsImNvbXBvbmVudCIsIndhcm4iLCJhdHRycyIsImF0dHIiLCJrdnAiLCJKU09OIiwic3RyaW5naWZ5IiwiaW5pdENvbXBvbmVudHMiLCJ0ZW1wbGF0ZXNfMCIsInRlbXBsYXRlRm9yQSIsImEiLCJ0ZW1wbGF0ZUZvckIiLCJiIiwidGVtcGxhdGVGb3JDIiwidGVtcGxhdGVGb3JEIiwidGVtcGxhdGVGb3JGIiwiZSIsImYiLCJ0ZW1wbGF0ZUZvckciLCJnIiwidGVtcGxhdGVGb3JIIiwibmVzdGVkQ29tcHV0ZWQiLCJ0ZW1wbGF0ZUFGb3JDb21wb25lbnRCIiwiYTEiLCJ0ZW1wbGF0ZUJGb3JDb21wb25lbnRCIiwiYjEiLCJ0ZW1wbGF0ZUZvckNoaWxkQ29tcG9uZW50UGxhY2Vob2xkZXIiLCJjb21wb25lbnRPbmUi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LCJmaWxlIjoiYnVuZGxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7XG4gXHRcdFx0XHRjb25maWd1cmFibGU6IGZhbHNlLFxuIFx0XHRcdFx0ZW51bWVyYWJsZTogdHJ1ZSxcbiBcdFx0XHRcdGdldDogZ2V0dGVyXG4gXHRcdFx0fSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiL1wiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMCk7XG4iLCIvL0dsb2JhbCB2YXJpYWJsZXNcclxubGV0IGdsb2JhbFdhdGNoZXJDb3VudCA9IDBcclxubGV0IGdsb2JhbERlcFRyYWNrZXJDb3VudCA9IDBcclxuZXhwb3J0IHtnbG9iYWxXYXRjaGVyQ291bnQsIGdsb2JhbERlcFRyYWNrZXJDb3VudH0iLCIgaW1wb3J0IHtnbG9iYWxEZXBUcmFja2VyQ291bnR9IGZyb20gJy4uL2dsb2JhbHMuanMnXHJcbiAvL0RlcGVuZGVuY3kgVHJhY2tlciwgbWFpbnRhaW5zIGEgbGlzdCBvZiBzdWJzY3JpYmVycywgYW5kIGFuIGFjdGl2ZSB0YXJnZXQgKGNhbiBvbmx5IGJlIG9uZSBhdCBhbnkgcG9pbnQgaW4gdGltZSlcclxuY29uc3QgRGVwID0gZnVuY3Rpb24obmFtZSkge1xyXG4gIHRoaXMuc3Vic2NyaWJlcnMgPSBbXVxyXG4gIHRoaXMuZGVwZW5kID0gZnVuY3Rpb24ocykge1xyXG4gICAgaWYgKHRoaXMuc3Vic2NyaWJlcnMuZmluZCh2ID0+IHYuaWQgPT09IHMuaWQpID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgdGhpcy5zdWJzY3JpYmVycy5wdXNoKHMpXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAvLyBjb25zb2xlLmxvZyhzLmlkICsgJyBoYXMgYWxyZWFkeSBzdWJzY3JpYmVkIGZvciAnICsgdGhpcy5pZClcclxuICAgIH1cclxuICB9XHJcbiAgdGhpcy5ub3RpZnkgPSBmdW5jdGlvbigpIHtcclxuICAgIHRoaXMuc3Vic2NyaWJlcnMuZm9yRWFjaCgocykgPT4ge1xyXG4gICAgICBjb25zb2xlLmxvZyh0aGlzLm5hbWUgKyAnIG5vdGlmeWluZyAnICsgcy5uYW1lKVxyXG4gICAgICBzLnVwZGF0ZSgpXHJcbiAgICB9KVxyXG4gIH1cclxuICB0aGlzLmlkID0gZ2xvYmFsRGVwVHJhY2tlckNvdW50KytcclxuICB0aGlzLm5hbWUgPSBuYW1lXHJcbn1cclxuRGVwLnRhcmdldCA9IG51bGxcclxuZXhwb3J0IHtEZXB9XHJcbiIsImltcG9ydCB7Z2xvYmFsV2F0Y2hlckNvdW50fSBmcm9tICcuLi9nbG9iYWxzLmpzJ1xyXG4vL1dhdGNoZXIgLSBhdHRhY2hlcyBhcyBhbiBhY3RpdmUgZGVwIHRhcmdldCwgZmlyZXMgdGhlIHVwZGF0ZSBjYWxsYmFja1xyXG5leHBvcnQgY29uc3QgV2F0Y2hlciA9IGZ1bmN0aW9uKG5hbWUsIGNiLCB2bSwgLi4uYXJncykge1xyXG4gICAgdGhpcy51cGRhdGUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgY2IuYXBwbHkodm0sIGFyZ3MpXHJcbiAgICB9XHJcbiAgICB0aGlzLmlkID0gZ2xvYmFsV2F0Y2hlckNvdW50KytcclxuICAgIHRoaXMubmFtZSA9IG5hbWVcclxufSIsIiAgaW1wb3J0IHtEZXB9IGZyb20gJy4vZGVwLmpzJ1xyXG4gIGltcG9ydCB7V2F0Y2hlcn0gZnJvbSAnLi93YXRjaGVyLmpzJ1xyXG4gIGltcG9ydCB7dHJhdmVyc2VUb1Byb3B9IGZyb20gJy4uL3V0aWxzLmpzJ1xyXG5cclxuICAvL0ZuIHRvIGJpbmQgY29tcG9uZW50J3MgcHJvcHMgdG8gaHRtbCB0ZW1wbGF0ZVxyXG4gIGV4cG9ydCBjb25zdCBiaW5kUHJvcFRvVGVtcGxhdGUgPSBmdW5jdGlvbih0ZW1wbGF0ZSwgaWQsIHByb3AsIGNvbXBvbmVudElkKSB7XHJcbiAgICBjb25zb2xlLmxvZyhcImJpbmRQcm9wVG9UZW1wbGF0ZTpcIiArIGlkICsgXCI6XCIgKyB0aGlzW3Byb3BdKVxyXG4gICAgRGVwLnRhcmdldCA9IG5ldyBXYXRjaGVyKCdCaW5kaW5nIHByb3AgV2F0Y2hlcjogJyArIGlkLCB0aGlzLnJlbmRlciwgdGhpcywgdGVtcGxhdGUsIGlkLCBjb21wb25lbnRJZClcclxuICAgIGxldCB2YWwgPSB0eXBlb2YodGhpc1twcm9wXSkgPT09IFwiZnVuY3Rpb25cIiA/IHRoaXNbcHJvcF0uYXBwbHkodGhpcykgOiBwcm9wLmluZGV4T2YoJy4nKSAhPT0gLTEgPyB0cmF2ZXJzZVRvUHJvcCh0aGlzLCBwcm9wKSA6IHRoaXNbcHJvcF1cclxuICAgIERlcC50YXJnZXQgPSBudWxsXHJcbiAgfSIsIi8vVHJhdmVyc2UgdG8gdGhlIG5lc3RlZCBwcm9wXHJcbmNvbnN0IHRyYXZlcnNlVG9Qcm9wID0gKHRhcmdldCwgcHJvcHMpID0+IHtcclxuICAgIGxldCBfcHJvcHMgPSBwcm9wcy5zcGxpdCgnLicpXHJcbiAgICBjb25zb2xlLmxvZyhfcHJvcHMpXHJcbiAgICBsZXQgdmFsID0ge31cclxuICAgIGxldCBvID0gdGFyZ2V0W19wcm9wc1swXV1cclxuICAgIGZvciAobGV0IGkgPSAxOyBpIDwgX3Byb3BzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIG8gPSBvW19wcm9wc1tpXV1cclxuICAgIH1cclxuICAgIHJldHVybiBvXHJcbiAgfVxyXG4gIFxyXG4gIGV4cG9ydCB7dHJhdmVyc2VUb1Byb3B9XHJcbiBcclxuICAiLCIvL29ubHkgdGhpcyBndXkgc2hvdWxkIHRvdWNoIHRoZSBET00sIGtpZGRpbmcgbm90XHJcbmV4cG9ydCBjb25zdCByZW5kZXIgPSBmdW5jdGlvbiAodGVtcGxhdGUsIGlkLCBjb21wb25lbnRJZCkge1xyXG4gICAgbGV0IGVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpXHJcbiAgICBpZiAoIWVsKSB7XHJcbiAgICAgICAgbGV0IGNvbXBvbmVudFJvb3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChjb21wb25lbnRJZClcclxuICAgICAgICBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXHJcbiAgICAgICAgZWwuaWQgPSBpZFxyXG4gICAgICAgIGVsLmlubmVySFRNTCA9IHRlbXBsYXRlLmFwcGx5KHRoaXMpXHJcbiAgICAgICAgY29tcG9uZW50Um9vdC5hcHBlbmRDaGlsZChlbClcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgZWwuaW5uZXJIVE1MID0gdGVtcGxhdGUuYXBwbHkodGhpcylcclxuICAgICAgICBlbC5jbGFzc0xpc3QuYWRkKCdhY3RpdmVQcm9wcycpXHJcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgIGVsLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZVByb3BzJylcclxuICAgICAgICB9LCAzMDAwKVxyXG4gICAgfVxyXG59IiwiXHJcbmltcG9ydCB7IERlcCB9IGZyb20gJy4vZGVwLmpzJ1xyXG5pbXBvcnQgeyBXYXRjaGVyIH0gZnJvbSAnLi93YXRjaGVyLmpzJ1xyXG5pbXBvcnQgeyBiaW5kUHJvcFRvVGVtcGxhdGUgfSBmcm9tICcuL2JpbmRQcm9wLmpzJ1xyXG5pbXBvcnQgeyByZW5kZXIgfSBmcm9tICcuLi9yZW5kZXIuanMnXHJcblxyXG5jb25zdCBpbml0RGF0YSA9IGZ1bmN0aW9uIChvYmosIHJlYWN0aXZlLCBuZXN0ZWQpIHtcclxuICBpZiAodHlwZW9mIG9iaiAhPT0gJ29iamVjdCcpIHtcclxuICAgIHJldHVybiBvYmpcclxuICB9XHJcbiAgbGV0IHdyYXBwZXIgPSB7fVxyXG5cclxuICBmb3IgKGxldCBwcm9wIGluIG9iaikge1xyXG4gICAgbGV0IHZhbCA9IG9ialtwcm9wXVxyXG4gICAgaWYgKHR5cGVvZiBvYmpbcHJvcF0gPT09IFwib2JqZWN0XCIpIHtcclxuICAgICAgdmFsID0gaW5pdERhdGEob2JqW3Byb3BdLCByZWFjdGl2ZSwgdHJ1ZSlcclxuICAgIH1cclxuICAgIGxldCBkZXAgPSBuZXcgRGVwKHByb3ApXHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobmVzdGVkID8gd3JhcHBlciA6IHJlYWN0aXZlLCBwcm9wLCB7XHJcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmIChEZXAudGFyZ2V0KSB7XHJcbiAgICAgICAgICBkZXAuZGVwZW5kKERlcC50YXJnZXQpXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB2YWxcclxuICAgICAgfSxcclxuICAgICAgc2V0OiBmdW5jdGlvbiAobmV3VmFsKSB7XHJcbiAgICAgICAgdmFsID0gaW5pdERhdGEobmV3VmFsLCByZWFjdGl2ZSlcclxuICAgICAgICBkZXAubm90aWZ5KClcclxuICAgICAgfVxyXG4gICAgfSlcclxuICB9XHJcbiAgcmV0dXJuIG5lc3RlZCA/IHdyYXBwZXIgOiByZWFjdGl2ZVxyXG59XHJcblxyXG5jb25zdCBtYWtlUmVhY3RpdmUgPSBmdW5jdGlvbiAodm0sIHByb3BWYWx1ZUhhc2gsIHBhcmVudCkge1xyXG4gIGNvbnN0IGNvbXB1dGVkID0gdm0uY29tcHV0ZWRcclxuICBjb25zdCB0ZW1wbGF0ZXMgPSB2bS50ZW1wbGF0ZXNcclxuICBjb25zdCBwcm9wcyA9IHZtLnByb3BzIHx8IFtdXHJcbiAgY29uc3QgY29tcG9uZW50cyA9IHZtLmNvbXBvbmVudHMgfHwgW11cclxuICBjb25zdCBkYXRhID0gKHZtLmRhdGEgJiYgdm0uZGF0YSgpKSB8fCB7fVxyXG4gIGxldCByZWFjdGl2ZSA9IHt9XHJcblxyXG4gIHJlYWN0aXZlLnJlbmRlciA9IHJlbmRlclxyXG4gIHJlYWN0aXZlLmJpbmRQcm9wVG9UZW1wbGF0ZSA9IGJpbmRQcm9wVG9UZW1wbGF0ZVxyXG4gIHJlYWN0aXZlLm5hbWUgPSB2bS5uYW1lXHJcbiAgcmVhY3RpdmUuZWwgPSB2bS5lbFxyXG4gIFxyXG4gIGluaXREYXRhKGRhdGEsIHJlYWN0aXZlKVxyXG5cclxuICBpbml0Q29tcHV0ZWQocmVhY3RpdmUsIGNvbXB1dGVkKVxyXG5cclxuICBpbml0UHJvcHMocmVhY3RpdmUsIHByb3BzLCBwcm9wVmFsdWVIYXNoLCBwYXJlbnQpXHJcblxyXG4gIGluaXRUZW1wbGF0ZXMocmVhY3RpdmUsIHRlbXBsYXRlcylcclxuXHJcbiAgaW5pdENvbXBvbmVudHMocmVhY3RpdmUsIGNvbXBvbmVudHMpXHJcblxyXG4gIHJldHVybiByZWFjdGl2ZVxyXG59XHJcblxyXG5mdW5jdGlvbiBpbml0Q29tcHV0ZWQocmVhY3RpdmUsIGNvbXB1dGVkKSB7XHJcbiAgbGV0IGNvbXB1dGVkV2F0Y2hlcnMgPSB7fVxyXG4gIGxldCBjb21wdXRlZERlcHMgPSB7fVxyXG5cclxuICAvL1JlYWN0aXZlIGNvbXB1dGVkIHByb3BzXHJcbiAgZm9yIChsZXQgcHJvcCBpbiBjb21wdXRlZCkge1xyXG4gICAgbGV0IGNhY2hlZFZhbHVlID0gbnVsbFxyXG4gICAgLy9Db21wdXRlZCBwcm9wZXJ0aWVzIGdldHMgdGhlaXIgb3duIHdhdGNoZXJzIHdoaWNoIHJlY29tcHV0ZSB0aGUgZm4gYW5kIG5vdGlmeSBpdHMgZGVwZW5kZW50c1xyXG4gICAgY29tcHV0ZWRXYXRjaGVyc1twcm9wXSA9IG5ldyBXYXRjaGVyKCdDb21wdXRlZCB3YXRjaGVyIHByb3A6ICcgKyBwcm9wLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIGNhY2hlZFZhbHVlID0gY29tcHV0ZWRbcHJvcF0uYXBwbHkocmVhY3RpdmUpXHJcbiAgICAgIGNvbXB1dGVkRGVwc1twcm9wXS5ub3RpZnkoKVxyXG4gICAgfSwgbnVsbClcclxuXHJcbiAgICBEZXAudGFyZ2V0ID0gY29tcHV0ZWRXYXRjaGVyc1twcm9wXVxyXG4gICAgY2FjaGVkVmFsdWUgPSBjb21wdXRlZFtwcm9wXS5hcHBseShyZWFjdGl2ZSlcclxuICAgIERlcC50YXJnZXQgPSBudWxsXHJcblxyXG4gICAgY29tcHV0ZWREZXBzW3Byb3BdID0gbmV3IERlcChwcm9wKVxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHJlYWN0aXZlLCBwcm9wLCB7XHJcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmIChEZXAudGFyZ2V0KSB7XHJcbiAgICAgICAgICBjb21wdXRlZERlcHNbcHJvcF0uZGVwZW5kKERlcC50YXJnZXQpXHJcbiAgICAgICAgICBEZXAudGFyZ2V0ID0gbnVsbFxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gY2FjaGVkVmFsdWVcclxuICAgICAgfVxyXG4gICAgfSlcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGluaXRQcm9wcyhyZWFjdGl2ZSwgcHJvcHMsIHByb3BWYWx1ZUhhc2gsIHBhcmVudCkge1xyXG4gIGZvciAobGV0IHByb3Agb2YgcHJvcHMpIHtcclxuICAgIGxldCBkZXAgPSBuZXcgRGVwKHByb3ApXHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkocmVhY3RpdmUsIHByb3AsIHtcclxuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKERlcC50YXJnZXQpIHtcclxuICAgICAgICAgIGRlcC5kZXBlbmQoRGVwLnRhcmdldClcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHBhcmVudFtwcm9wVmFsdWVIYXNoW3Byb3BdXVxyXG4gICAgICB9XHJcbiAgICB9KVxyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gaW5pdFRlbXBsYXRlcyhyZWFjdGl2ZSwgdGVtcGxhdGVzKSB7XHJcbiAgZm9yIChsZXQgdGVtcGxhdGUgb2YgdGVtcGxhdGVzKSB7XHJcbiAgICByZWFjdGl2ZS5iaW5kUHJvcFRvVGVtcGxhdGUodGVtcGxhdGUuaHRtbCwgdGVtcGxhdGUuaWQsIHRlbXBsYXRlLnByb3ApXHJcbiAgICByZWFjdGl2ZS5yZW5kZXIodGVtcGxhdGUuaHRtbCwgdGVtcGxhdGUuaWQsIHJlYWN0aXZlLmVsKVxyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gaW5pdENvbXBvbmVudHMocmVhY3RpdmUsIGNvbXBvbmVudHMpIHtcclxuICBmb3IgKGxldCBjb21wb25lbnQgb2YgY29tcG9uZW50cykge1xyXG4gICAgbGV0IHRlbXBsYXRlID0gY29tcG9uZW50LnRlbXBsYXRlKClcclxuICAgIGxldCBuYW1lID0gY29tcG9uZW50Lm5hbWVcclxuICAgIGxldCB2YWx1ZSA9IGNvbXBvbmVudC52YWx1ZVxyXG4gICAgbGV0IGNoaWxkVGVtcGxhdGVzID0gdmFsdWUudGVtcGxhdGVzXHJcbiAgICBpZiAodGVtcGxhdGUuaW5kZXhPZihuYW1lKSA9PT0gLTEpIHtcclxuICAgICAgY29uc29sZS53YXJuKGAke25hbWV9IG5vdCBkZWZpbmVkIGluIHRoZSB0ZW1wbGF0ZWApXHJcbiAgICAgIGJyZWFrXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBsZXQgYXR0cnMgPSB0ZW1wbGF0ZS5zcGxpdCgnPC8nICsgbmFtZSArICc+JylbMF0uc3BsaXQoJ2RhdGEtJylcclxuICAgICAgbGV0IHByb3BWYWx1ZUhhc2ggPSB7fVxyXG4gICAgICBmb3IgKGxldCBhdHRyIG9mIGF0dHJzKSB7XHJcbiAgICAgICAgaWYgKGF0dHIuaW5kZXhPZignPScpICE9PSAtMSkge1xyXG4gICAgICAgICAgbGV0IGt2cCA9IGF0dHIuc3BsaXQoJz0nKVxyXG4gICAgICAgICAgcHJvcFZhbHVlSGFzaFtrdnBbMF1dID0ga3ZwWzFdLnNwbGl0KCdcIicpWzFdXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGNvbnNvbGUubG9nKCdwcm9wVmFsdWVIYXNoOicgKyBKU09OLnN0cmluZ2lmeShwcm9wVmFsdWVIYXNoKSlcclxuICAgICAgbWFrZVJlYWN0aXZlKHZhbHVlLCBwcm9wVmFsdWVIYXNoLCByZWFjdGl2ZSlcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCB7IG1ha2VSZWFjdGl2ZSB9XHJcblxyXG4iLCJcclxubGV0IHRlbXBsYXRlRm9yQSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgcmV0dXJuIGA8cD5IZWxsbywgSSBhbSBhIDxpPmRhdGE8L2k+IHByb3AuIFlvdSBjYW4gY2FsbCBtZSA8c3Ryb25nPkE8L3N0cm9uZz46ICR7dGhpcy5hfTwvcD5gXHJcbiAgfVxyXG4gIFxyXG4gIGxldCB0ZW1wbGF0ZUZvckIgPSBmdW5jdGlvbigpIHtcclxuICAgIHJldHVybiBgPHA+SGVsbG8sIEkgYW0gYSA8aT5jb21wdXRlZDwvaT4gcHJvcC4gWW91IGNhbiBjYWxsIG1lIDxzdHJvbmc+Qjwvc3Ryb25nPiAoQSAqIDEwKTogJHt0aGlzLmJ9PC9wPmBcclxuICB9XHJcbiAgXHJcbiAgbGV0IHRlbXBsYXRlRm9yQyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgcmV0dXJuIGA8cD5IZWxsbywgSSBhbSBhIDxpPmRhdGE8L2k+IHByb3AuIFlvdSBjYW4gY2FsbCBtZSA8c3Ryb25nPkM8L3N0cm9uZz46ICR7dGhpcy5jfTwvcD5gXHJcbiAgfVxyXG4gIFxyXG4gIGxldCB0ZW1wbGF0ZUZvckQgPSBmdW5jdGlvbigpIHtcclxuICAgIHJldHVybiBgPHA+SGVsbG8sIEkgYW0gYSA8aT5jb21wdXRlZDwvaT4gcHJvcC4gWW91IGNhbiBjYWxsIG1lIDxzdHJvbmc+RDwvc3Ryb25nPiAoQiArIDExKTogJHt0aGlzLmR9PC9wPmBcclxuICB9XHJcbiAgXHJcbiAgXHJcbiAgbGV0IHRlbXBsYXRlRm9yRiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgcmV0dXJuIGA8cD5IZWxsbywgSSBhbSBhIDxpPm5lc3RlZCBkYXRhPC9pPiBwcm9wLiBZb3UgY2FuIGNhbGwgbWUgPHN0cm9uZz5GPC9zdHJvbmc+KExlbmd0aCk6ICR7dGhpcy5lLmZ9PC9wPmBcclxuICB9XHJcbiAgXHJcbiAgbGV0IHRlbXBsYXRlRm9yRyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgcmV0dXJuIGA8cD5IZWxsbywgSSBhbSBhIDxpPm5lc3RlZCBkYXRhPC9pPiBwcm9wLiBZb3UgY2FuIGNhbGwgbWUgPHN0cm9uZz5HPC9zdHJvbmc+KFdpZHRoKTogJHt0aGlzLmUuZ308L3A+YFxyXG4gIH1cclxuICBcclxuICBsZXQgdGVtcGxhdGVGb3JIID0gZnVuY3Rpb24oKSB7XHJcbiAgICByZXR1cm4gYDxwPkhlbGxvLCBJIGFtIGEgPGk+bmVzdGVkIGNvbXB1dGVkPC9pPiBwcm9wLiBZb3UgY2FuIGNhbGwgbWUgPHN0cm9uZz5IPC9zdHJvbmc+KEFyZWEpOiAke3RoaXMubmVzdGVkQ29tcHV0ZWR9PC9wPmBcclxuICB9XHJcbiAgXHJcbiAgbGV0IHRlbXBsYXRlQUZvckNvbXBvbmVudEIgPSBmdW5jdGlvbigpIHtcclxuICAgIHJldHVybiBgPHA+SSdtIGEgY2hpbGQgY29tcG9uZW50IEkgaGF2ZSBpbmhlcml0ZWQgbXkgcGFyZW50J3MgcHJvcGVydHkgYTogJHt0aGlzLmExfTwvcD5gXHJcbiAgfVxyXG4gIFxyXG4gIGxldCB0ZW1wbGF0ZUJGb3JDb21wb25lbnRCID0gZnVuY3Rpb24oKSB7XHJcbiAgICByZXR1cm4gYDxwPkknbSBhIGNoaWxkIGNvbXBvbmVudC4gVGhpcyBpcyBteSBwcm9wZXJ0eSBCMTogJHt0aGlzLmIxfTwvcD5gXHJcbiAgfVxyXG4gIFxyXG4gIGxldCB0ZW1wbGF0ZUZvckNoaWxkQ29tcG9uZW50UGxhY2Vob2xkZXIgPSBmdW5jdGlvbigpIHtcclxuICAgIHJldHVybiBgPG15LWNoaWxkLWNvbXBvbmVudCBkYXRhLWExPVwiYVwiPjwvbXktY2hpbGQtY29tcG9uZW50PmBcclxuICB9XHJcblxyXG4gIGV4cG9ydCBkZWZhdWx0IHtcclxuICAgICAgdGVtcGxhdGVGb3JBLFxyXG4gICAgICB0ZW1wbGF0ZUZvckIsXHJcbiAgICAgIHRlbXBsYXRlRm9yQyxcclxuICAgICAgdGVtcGxhdGVGb3JELFxyXG4gICAgICB0ZW1wbGF0ZUZvckYsXHJcbiAgICAgIHRlbXBsYXRlRm9yRyxcclxuICAgICAgdGVtcGxhdGVGb3JILFxyXG4gICAgICB0ZW1wbGF0ZUFGb3JDb21wb25lbnRCLFxyXG4gICAgICB0ZW1wbGF0ZUJGb3JDb21wb25lbnRCLFxyXG4gICAgICB0ZW1wbGF0ZUZvckNoaWxkQ29tcG9uZW50UGxhY2Vob2xkZXJcclxuICB9IiwiLy9Db21wb25lbnQgRGVmaW5pdGlvbnNcclxuaW1wb3J0IHRlbXAgZnJvbSAnLi90ZW1wbGF0ZXMuanMnXHJcbmNvbnN0IGNoaWxkQ29tcG9uZW50ID0ge1xyXG4gICAgbmFtZTogJ2NoaWxkQ29tcG9uZW50JyxcclxuICAgIGVsOiAnY2hpbGRDb21wb25lbnQnLFxyXG4gICAgcHJvcHM6IFsnYTEnXSxcclxuICAgIGRhdGEoKSB7XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgYjE6IDEwXHJcbiAgICAgIH1cclxuICAgIH0sXHJcbiAgICB0ZW1wbGF0ZXM6IFt7XHJcbiAgICAgICAgaHRtbDogdGVtcC50ZW1wbGF0ZUFGb3JDb21wb25lbnRCLFxyXG4gICAgICAgIGlkOiBcImNoaWxkX2FcIixcclxuICAgICAgICBwcm9wOiBcImExXCJcclxuICAgICAgfSxcclxuICAgICAge1xyXG4gICAgICAgIGh0bWw6IHRlbXAudGVtcGxhdGVCRm9yQ29tcG9uZW50QixcclxuICAgICAgICBpZDogXCJjaGlsZF9iXCIsXHJcbiAgICAgICAgcHJvcDogXCJiMVwiXHJcbiAgICAgIH1cclxuICAgIF1cclxuICB9XHJcbiAgXHJcbiAgY29uc3QgY29tcG9uZW50T25lID0ge1xyXG4gICAgbmFtZTogJ2NvbXBvbmVudE9uZScsXHJcbiAgICBkYXRhKCkge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGE6IDUsXHJcbiAgICAgICAgYzogJ0hlbGxvIHRoZXJlISEnLFxyXG4gICAgICAgIGU6IHtcclxuICAgICAgICAgIGY6IDUsXHJcbiAgICAgICAgICBnOiA2XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9LFxyXG4gICAgY29tcHV0ZWQ6IHtcclxuICAgICAgYjogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYSAqIDEwXHJcbiAgICAgIH0sXHJcbiAgICAgIGQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmIgKyAxMVxyXG4gICAgICB9LFxyXG4gICAgICBuZXN0ZWRDb21wdXRlZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKGlzTmFOKHRoaXMuZS5mKSB8fCBpc05hTih0aGlzLmUuZykpIHtcclxuICAgICAgICAgIHJldHVybiAwXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLmUuZiAqIHRoaXMuZS5nXHJcbiAgICAgIH1cclxuICAgIH0sXHJcbiAgICBlbDogJ2NvbXBvbmVudE9uZScsXHJcbiAgICB0ZW1wbGF0ZXM6IFt7XHJcbiAgICAgICAgaHRtbDogdGVtcC50ZW1wbGF0ZUZvckEsXHJcbiAgICAgICAgaWQ6IFwiYVwiLFxyXG4gICAgICAgIHByb3A6IFwiYVwiXHJcbiAgICAgIH0sXHJcbiAgICAgIHtcclxuICAgICAgICBodG1sOiB0ZW1wLnRlbXBsYXRlRm9yQixcclxuICAgICAgICBpZDogXCJiXCIsXHJcbiAgICAgICAgcHJvcDogXCJiXCJcclxuICAgICAgfSxcclxuICAgICAge1xyXG4gICAgICAgIGh0bWw6IHRlbXAudGVtcGxhdGVGb3JDLFxyXG4gICAgICAgIGlkOiBcImNcIixcclxuICAgICAgICBwcm9wOiBcImNcIlxyXG4gICAgICB9LFxyXG4gICAgICB7XHJcbiAgICAgICAgaHRtbDogdGVtcC50ZW1wbGF0ZUZvckQsXHJcbiAgICAgICAgaWQ6IFwiZFwiLFxyXG4gICAgICAgIHByb3A6IFwiZFwiXHJcbiAgICAgIH0sXHJcbiAgICAgIHtcclxuICAgICAgICBodG1sOiB0ZW1wLnRlbXBsYXRlRm9yRixcclxuICAgICAgICBpZDogXCJmXCIsXHJcbiAgICAgICAgcHJvcDogXCJlLmZcIlxyXG4gICAgICB9LFxyXG4gICAgICB7XHJcbiAgICAgICAgaHRtbDogdGVtcC50ZW1wbGF0ZUZvckcsXHJcbiAgICAgICAgaWQ6IFwiZ1wiLFxyXG4gICAgICAgIHByb3A6IFwiZS5nXCJcclxuICAgICAgfSxcclxuICAgICAge1xyXG4gICAgICAgIGh0bWw6IHRlbXAudGVtcGxhdGVGb3JILFxyXG4gICAgICAgIGlkOiBcImhcIixcclxuICAgICAgICBwcm9wOiBcIm5lc3RlZENvbXB1dGVkXCJcclxuICAgICAgfVxyXG4gICAgXSxcclxuICAgIGNvbXBvbmVudHM6IFt7XHJcbiAgICAgIG5hbWU6ICdteS1jaGlsZC1jb21wb25lbnQnLFxyXG4gICAgICB2YWx1ZTogY2hpbGRDb21wb25lbnQsXHJcbiAgICAgIHRlbXBsYXRlOiB0ZW1wLnRlbXBsYXRlRm9yQ2hpbGRDb21wb25lbnRQbGFjZWhvbGRlclxyXG4gICAgfV1cclxuICB9XHJcblxyXG4gIGV4cG9ydCB7Y2hpbGRDb21wb25lbnQsIGNvbXBvbmVudE9uZX0iLCJpbXBvcnQge21ha2VSZWFjdGl2ZX0gZnJvbSAnLi9yZWFjdGl2ZS9vYnNlcnZlci5qcydcclxuaW1wb3J0IHtjb21wb25lbnRPbmV9IGZyb20gJy4vY29tcG9uZW50cy5qcydcclxuLy9FdmVudCBoYW5kbGVyIGZvciBpbnB1dCBjaGFuZ2VzXHJcbmZ1bmN0aW9uIHNldFZhbEZvckEoZSkge1xyXG4gICAgbGV0IHZhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbnB1dEEnKS52YWx1ZTtcclxuICAgIGlmICghaXNOYU4odmFsKSkge1xyXG4gICAgICBteUZpcnN0UmVhY3RpdmVDb21wb25lbnQuYSA9IHZhbFxyXG4gICAgfVxyXG4gIH1cclxuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW5wdXRBJykub25jaGFuZ2UgPSBzZXRWYWxGb3JBXHJcbiAgXHJcbiAgZnVuY3Rpb24gc2V0VmFsRm9yQyhlKSB7XHJcbiAgICBsZXQgdmFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2lucHV0QycpLnZhbHVlO1xyXG4gICAgbXlGaXJzdFJlYWN0aXZlQ29tcG9uZW50LmMgPSB2YWxcclxuICB9XHJcbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2lucHV0QycpLm9uY2hhbmdlID0gc2V0VmFsRm9yQ1xyXG4gIFxyXG4gIGZ1bmN0aW9uIHNldFZhbEZvckYoZSkge1xyXG4gICAgbGV0IHZhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbnB1dEYnKS52YWx1ZTtcclxuICAgIG15Rmlyc3RSZWFjdGl2ZUNvbXBvbmVudC5lLmYgPSB2YWxcclxuICB9XHJcbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2lucHV0RicpLm9uY2hhbmdlID0gc2V0VmFsRm9yRlxyXG4gIFxyXG4gIGZ1bmN0aW9uIHNldFZhbEZvckcoZSkge1xyXG4gICAgbGV0IHZhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbnB1dEcnKS52YWx1ZTtcclxuICAgIG15Rmlyc3RSZWFjdGl2ZUNvbXBvbmVudC5lLmcgPSB2YWxcclxuICB9XHJcbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbnB1dEcnKS5vbmNoYW5nZSA9IHNldFZhbEZvckdcclxuXHJcbmxldCBteUZpcnN0UmVhY3RpdmVDb21wb25lbnQgPSBtYWtlUmVhY3RpdmUoY29tcG9uZW50T25lKVxyXG5jb25zb2xlLmxvZyhteUZpcnN0UmVhY3RpdmVDb21wb25lbnQpXHJcbnNldFRpbWVvdXQoKCkgPT4ge1xyXG4gIG15Rmlyc3RSZWFjdGl2ZUNvbXBvbmVudC5jID0gXCJoZWxsbyBDaGljYWdvISFcIlxyXG59LCAyMDAwKVxyXG5cclxuIl0sInNvdXJjZVJvb3QiOiIifQ==