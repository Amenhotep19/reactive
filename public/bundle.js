var Reactivity=function(t){var e={};function n(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:o})},n.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/",n(n.s=0)}([function(t,e,n){"use strict";n.r(e);let o=0,r=0;const i=function(t){this.subscribers=[],this.depend=function(t){void 0===this.subscribers.find(e=>e.id===t.id)&&this.subscribers.push(t)},this.notify=function(){this.subscribers.forEach(t=>{console.log(this.name+" notifying "+t.name),t.update()})},this.id=r++,this.name=t};i.target=null;const l=function(t,e,n,...r){this.update=function(){e.apply(n,r)},this.id=o++,this.name=t},p=function(t,e,n){console.log("bindPropToTemplate:"+e+":"+this[n]),i.target=new l("Binding prop Watcher: "+e,this.render,this,t,e);"function"==typeof this[n]?this[n].apply(this):-1!==n.indexOf(".")?((t,e)=>{let n=e.split(".");console.log(n);let o=t[n[0]];for(let t=1;t<n.length;t++)o=o[n[t]]})(this,n):this[n];i.target=null},a=function(t,e){document.getElementById(e).innerHTML=t.apply(this),document.getElementById(e).classList.add("activeProps"),setTimeout(()=>{document.getElementById(e).classList.remove("activeProps")},3e3)},c=function(t,e,n){if("object"!=typeof t)return t;let o={};for(let r in t){let l=t[r];"object"==typeof t[r]&&(l=c(t[r],e,!0));let p=new i(r);Object.defineProperty(n?o:e,r,{get:function(){return i.target&&p.depend(i.target),l},set:function(t){l=c(t,e),p.notify()}})}return n?o:e},u=function(t,e,n){let o={};o.render=a,o.bindPropToTemplate=p;const r=t.computed,s=t.templates,m=t.props||[],d=t.components||[],f=t.data&&t.data()||{};return c(f,o),function(t,e){let n={},o={};for(let r in e){let p;n[r]=new l("Computed watcher prop: "+r,function(){p=e[r].apply(t),o[r].notify()},null),i.target=n[r],p=e[r].apply(t),i.target=null,o[r]=new i(r),Object.defineProperty(t,r,{get:function(){return i.target&&(o[r].depend(i.target),i.target=null),p}})}}(o,r),function(t,e,n,o){for(let r of e){let e=new i(r);Object.defineProperty(t,r,{get:function(){return i.target&&e.depend(i.target),o[n[r]]}})}}(o,m,e,n),function(t,e){for(let n of e)t.bindPropToTemplate(n.html,n.id,n.prop),t.render(n.html,n.id)}(o,s),function(t,e){for(let n of e){let e=n.template(),o=n.name,r=n.value;r.templates;if(-1===e.indexOf(o)){console.warn(`${o} not defined in the template`);break}{let n=e.split("</"+o+">")[0].split("data-"),i={};for(let t of n)if(-1!==t.indexOf("=")){let e=t.split("=");i[e[0]]=e[1].split('"')[1]}console.log("propValueHash:"+JSON.stringify(i)),u(r,i,t)}}}(o,d),o};var s={templateForA:function(){return`<p>Hello, I am a <i>data</i> prop. You can call me <strong>A</strong>: ${this.a}</p>`},templateForB:function(){return`<p>Hello, I am a <i>computed</i> prop. You can call me <strong>B</strong> (A * 10): ${this.b}</p>`},templateForC:function(){return`<p>Hello, I am a <i>data</i> prop. You can call me <strong>C</strong>: ${this.c}</p>`},templateForD:function(){return`<p>Hello, I am a <i>computed</i> prop. You can call me <strong>D</strong> (B + 11): ${this.d}</p>`},templateForF:function(){return`<p>Hello, I am a <i>nested data</i> prop. You can call me <strong>F</strong>(Length): ${this.e.f}</p>`},templateForG:function(){return`<p>Hello, I am a <i>nested data</i> prop. You can call me <strong>G</strong>(Width): ${this.e.g}</p>`},templateForH:function(){return`<p>Hello, I am a <i>nested computed</i> prop. You can call me <strong>H</strong>(Area): ${this.nestedComputed}</p>`},templateAForComponentB:function(){return`<p>I'm a child component I have inherited my parent's property a: ${this.a1}</p>`},templateBForComponentB:function(){return`<p>I'm a child component. This is my property B1: ${this.b1}</p>`},templateForChildComponentPlaceholder:function(){return'<my-child-component data-a1="a"></my-child-component>'}};const m={name:"componentOne",data:()=>({a:5,c:"Hello there!!",e:{f:5,g:6}}),computed:{b:function(){return 10*this.a},d:function(){return this.b+11},nestedComputed:function(){return isNaN(this.e.f)||isNaN(this.e.g)?0:this.e.f*this.e.g}},el:"appRoot",templates:[{html:s.templateForA,id:"a",prop:"a"},{html:s.templateForB,id:"b",prop:"b"},{html:s.templateForC,id:"c",prop:"c"},{html:s.templateForD,id:"d",prop:"d"},{html:s.templateForF,id:"f",prop:"e.f"},{html:s.templateForG,id:"g",prop:"e.g"},{html:s.templateForH,id:"h",prop:"nestedComputed"}],components:[{name:"my-child-component",value:{name:"childComponent",props:["a1"],data:()=>({b1:10}),templates:[{html:s.templateAForComponentB,id:"child_a",prop:"a1"},{html:s.templateBForComponentB,id:"child_b",prop:"b1"}]},template:s.templateForChildComponentPlaceholder}]};document.getElementById("inputA").onchange=function(t){let e=document.getElementById("inputA").value;isNaN(e)||(d.a=e)},document.getElementById("inputC").onchange=function(t){let e=document.getElementById("inputC").value;d.c=e},document.getElementById("inputF").onchange=function(t){let e=document.getElementById("inputF").value;d.e.f=e},document.getElementById("inputG").onchange=function(t){let e=document.getElementById("inputG").value;d.e.g=e};let d=u(m);console.log(d),setTimeout(()=>{d.c="hello Chicago!!"},2e3)}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9SZWFjdGl2aXR5L3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL1JlYWN0aXZpdHkvLi9nbG9iYWxzLmpzIiwid2VicGFjazovL1JlYWN0aXZpdHkvLi9yZWFjdGl2ZS9kZXAuanMiLCJ3ZWJwYWNrOi8vUmVhY3Rpdml0eS8uL3JlYWN0aXZlL3dhdGNoZXIuanMiLCJ3ZWJwYWNrOi8vUmVhY3Rpdml0eS8uL3JlYWN0aXZlL2JpbmRQcm9wLmpzIiwid2VicGFjazovL1JlYWN0aXZpdHkvLi91dGlscy5qcyIsIndlYnBhY2s6Ly9SZWFjdGl2aXR5Ly4vcmVuZGVyLmpzIiwid2VicGFjazovL1JlYWN0aXZpdHkvLi9yZWFjdGl2ZS9vYnNlcnZlci5qcyIsIndlYnBhY2s6Ly9SZWFjdGl2aXR5Ly4vdGVtcGxhdGVzLmpzIiwid2VicGFjazovL1JlYWN0aXZpdHkvLi9jb21wb25lbnRzLmpzIiwid2VicGFjazovL1JlYWN0aXZpdHkvLi90ZXN0LmpzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJjb25maWd1cmFibGUiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsInZhbHVlIiwibiIsIl9fZXNNb2R1bGUiLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJnbG9iYWxXYXRjaGVyQ291bnQiLCJnbG9iYWxEZXBUcmFja2VyQ291bnQiLCJEZXAiLCJ0aGlzIiwic3Vic2NyaWJlcnMiLCJkZXBlbmQiLCJ1bmRlZmluZWQiLCJmaW5kIiwidiIsImlkIiwicHVzaCIsIm5vdGlmeSIsImZvckVhY2giLCJjb25zb2xlIiwibG9nIiwidXBkYXRlIiwidGFyZ2V0IiwiV2F0Y2hlciIsImNiIiwidm0iLCJhcmdzIiwiYXBwbHkiLCJiaW5kUHJvcFRvVGVtcGxhdGUiLCJ0ZW1wbGF0ZSIsInByb3AiLCJyZW5kZXIiLCJpbmRleE9mIiwicHJvcHMiLCJfcHJvcHMiLCJzcGxpdCIsImxlbmd0aCIsInRyYXZlcnNlVG9Qcm9wIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImlubmVySFRNTCIsImNsYXNzTGlzdCIsImFkZCIsInNldFRpbWVvdXQiLCJyZW1vdmUiLCJpbml0RGF0YSIsIm9iaiIsInJlYWN0aXZlIiwibmVzdGVkIiwid3JhcHBlciIsInZhbCIsImRlcCIsInNldCIsIm5ld1ZhbCIsIm1ha2VSZWFjdGl2ZSIsInByb3BWYWx1ZUhhc2giLCJwYXJlbnQiLCJjb21wdXRlZCIsInRlbXBsYXRlcyIsImNvbXBvbmVudHMiLCJkYXRhIiwiY29tcHV0ZWRXYXRjaGVycyIsImNvbXB1dGVkRGVwcyIsImNhY2hlZFZhbHVlIiwiaW5pdENvbXB1dGVkIiwiaW5pdFByb3BzIiwiaHRtbCIsImluaXRUZW1wbGF0ZXMiLCJjb21wb25lbnQiLCJ3YXJuIiwiYXR0cnMiLCJhdHRyIiwia3ZwIiwiSlNPTiIsInN0cmluZ2lmeSIsImluaXRDb21wb25lbnRzIiwidGVtcGxhdGVzXzAiLCJ0ZW1wbGF0ZUZvckEiLCJhIiwidGVtcGxhdGVGb3JCIiwiYiIsInRlbXBsYXRlRm9yQyIsInRlbXBsYXRlRm9yRCIsInRlbXBsYXRlRm9yRiIsImUiLCJmIiwidGVtcGxhdGVGb3JHIiwiZyIsInRlbXBsYXRlRm9ySCIsIm5lc3RlZENvbXB1dGVkIiwidGVtcGxhdGVBRm9yQ29tcG9uZW50QiIsImExIiwidGVtcGxhdGVCRm9yQ29tcG9uZW50QiIsImIxIiwidGVtcGxhdGVGb3JDaGlsZENvbXBvbmVudFBsYWNlaG9sZGVyIiwiY29tcG9uZW50T25lIiwiaXNOYU4iLCJlbCIsIm9uY2hhbmdlIiwibXlGaXJzdFJlYWN0aXZlQ29tcG9uZW50Il0sIm1hcHBpbmdzIjoi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QUEsTUFDQTJCLEtBQUEsTUFFQWlDLEdBQUEsS0FHQW5DLFlBQ0FRLEtBQUFVLEVBQUFjLHVCQUNBM0UsR0FBQSxVQUNBZSxLQUFBLE9BR0FvQyxLQUFBVSxFQUFBZ0IsdUJBQ0E3RSxHQUFBLFVBQ0FlLEtBQUEsUUF1RUFELFNBQUErQyxFQUFBa0Isd0NDaEZBeEQsU0FBQUMsZUFBQSxVQUFBMkQsU0FOQSxTQUFBZCxHQUNBLElBQUFsQyxFQUFBWixTQUFBQyxlQUFBLFVBQUExQyxNQUNBbUcsTUFBQTlDLEtBQ0FpRCxFQUFBckIsRUFBQTVCLElBU0FaLFNBQUFDLGVBQUEsVUFBQTJELFNBSkEsU0FBQWQsR0FDQSxJQUFBbEMsRUFBQVosU0FBQUMsZUFBQSxVQUFBMUMsTUFDQXNHLEVBQUFqSCxFQUFBZ0UsR0FRQVosU0FBQUMsZUFBQSxVQUFBMkQsU0FKQSxTQUFBZCxHQUNBLElBQUFsQyxFQUFBWixTQUFBQyxlQUFBLFVBQUExQyxNQUNBc0csRUFBQWYsRUFBQUMsRUFBQW5DLEdBUUFaLFNBQUFDLGVBQUEsVUFBQTJELFNBSkEsU0FBQWQsR0FDQSxJQUFBbEMsRUFBQVosU0FBQUMsZUFBQSxVQUFBMUMsTUFDQXNHLEVBQUFmLEVBQUFHLEVBQUFyQyxHQUlBLElBQUFpRCxFQUFBN0MsRUFBQXlDLEdBQ0E1RSxRQUFBQyxJQUFBK0UsR0FDQXhELFdBQUEsS0FDQXdELEVBQUFqSCxFQUFBLG1CQUNDIiwiZmlsZSI6ImJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwge1xuIFx0XHRcdFx0Y29uZmlndXJhYmxlOiBmYWxzZSxcbiBcdFx0XHRcdGVudW1lcmFibGU6IHRydWUsXG4gXHRcdFx0XHRnZXQ6IGdldHRlclxuIFx0XHRcdH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIi9cIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDApO1xuIiwiLy9HbG9iYWwgdmFyaWFibGVzXHJcbmxldCBnbG9iYWxXYXRjaGVyQ291bnQgPSAwXHJcbmxldCBnbG9iYWxEZXBUcmFja2VyQ291bnQgPSAwXHJcbmV4cG9ydCB7Z2xvYmFsV2F0Y2hlckNvdW50LCBnbG9iYWxEZXBUcmFja2VyQ291bnR9IiwiIGltcG9ydCB7Z2xvYmFsRGVwVHJhY2tlckNvdW50fSBmcm9tICcuLi9nbG9iYWxzLmpzJ1xyXG4gLy9EZXBlbmRlbmN5IFRyYWNrZXIsIG1haW50YWlucyBhIGxpc3Qgb2Ygc3Vic2NyaWJlcnMsIGFuZCBhbiBhY3RpdmUgdGFyZ2V0IChjYW4gb25seSBiZSBvbmUgYXQgYW55IHBvaW50IGluIHRpbWUpXHJcbmNvbnN0IERlcCA9IGZ1bmN0aW9uKG5hbWUpIHtcclxuICB0aGlzLnN1YnNjcmliZXJzID0gW11cclxuICB0aGlzLmRlcGVuZCA9IGZ1bmN0aW9uKHMpIHtcclxuICAgIGlmICh0aGlzLnN1YnNjcmliZXJzLmZpbmQodiA9PiB2LmlkID09PSBzLmlkKSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIHRoaXMuc3Vic2NyaWJlcnMucHVzaChzKVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgLy8gY29uc29sZS5sb2cocy5pZCArICcgaGFzIGFscmVhZHkgc3Vic2NyaWJlZCBmb3IgJyArIHRoaXMuaWQpXHJcbiAgICB9XHJcbiAgfVxyXG4gIHRoaXMubm90aWZ5ID0gZnVuY3Rpb24oKSB7XHJcbiAgICB0aGlzLnN1YnNjcmliZXJzLmZvckVhY2goKHMpID0+IHtcclxuICAgICAgY29uc29sZS5sb2codGhpcy5uYW1lICsgJyBub3RpZnlpbmcgJyArIHMubmFtZSlcclxuICAgICAgcy51cGRhdGUoKVxyXG4gICAgfSlcclxuICB9XHJcbiAgdGhpcy5pZCA9IGdsb2JhbERlcFRyYWNrZXJDb3VudCsrXHJcbiAgdGhpcy5uYW1lID0gbmFtZVxyXG59XHJcbkRlcC50YXJnZXQgPSBudWxsXHJcbmV4cG9ydCB7RGVwfVxyXG4iLCJpbXBvcnQge2dsb2JhbFdhdGNoZXJDb3VudH0gZnJvbSAnLi4vZ2xvYmFscy5qcydcclxuLy9XYXRjaGVyIC0gYXR0YWNoZXMgYXMgYW4gYWN0aXZlIGRlcCB0YXJnZXQsIGZpcmVzIHRoZSB1cGRhdGUgY2FsbGJhY2tcclxuZXhwb3J0IGNvbnN0IFdhdGNoZXIgPSBmdW5jdGlvbihuYW1lLCBjYiwgdm0sIC4uLmFyZ3MpIHtcclxuICAgIHRoaXMudXBkYXRlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgIGNiLmFwcGx5KHZtLCBhcmdzKVxyXG4gICAgfVxyXG4gICAgdGhpcy5pZCA9IGdsb2JhbFdhdGNoZXJDb3VudCsrXHJcbiAgICB0aGlzLm5hbWUgPSBuYW1lXHJcbn0iLCIgIGltcG9ydCB7RGVwfSBmcm9tICcuL2RlcC5qcydcclxuICBpbXBvcnQge1dhdGNoZXJ9IGZyb20gJy4vd2F0Y2hlci5qcydcclxuICBpbXBvcnQge3RyYXZlcnNlVG9Qcm9wfSBmcm9tICcuLi91dGlscy5qcydcclxuXHJcbiAgLy9GbiB0byBiaW5kIGNvbXBvbmVudCdzIHByb3BzIHRvIGh0bWwgdGVtcGxhdGVcclxuICBleHBvcnQgY29uc3QgYmluZFByb3BUb1RlbXBsYXRlID0gZnVuY3Rpb24odGVtcGxhdGUsIGlkLCBwcm9wKSB7XHJcbiAgICBjb25zb2xlLmxvZyhcImJpbmRQcm9wVG9UZW1wbGF0ZTpcIiArIGlkICsgXCI6XCIgKyB0aGlzW3Byb3BdKVxyXG4gICAgRGVwLnRhcmdldCA9IG5ldyBXYXRjaGVyKCdCaW5kaW5nIHByb3AgV2F0Y2hlcjogJyArIGlkLCB0aGlzLnJlbmRlciwgdGhpcywgdGVtcGxhdGUsIGlkKVxyXG4gICAgbGV0IHZhbCA9IHR5cGVvZih0aGlzW3Byb3BdKSA9PT0gXCJmdW5jdGlvblwiID8gdGhpc1twcm9wXS5hcHBseSh0aGlzKSA6IHByb3AuaW5kZXhPZignLicpICE9PSAtMSA/IHRyYXZlcnNlVG9Qcm9wKHRoaXMsIHByb3ApIDogdGhpc1twcm9wXVxyXG4gICAgRGVwLnRhcmdldCA9IG51bGxcclxuICB9IiwiLy9UcmF2ZXJzZSB0byB0aGUgbmVzdGVkIHByb3BcclxuY29uc3QgdHJhdmVyc2VUb1Byb3AgPSAodGFyZ2V0LCBwcm9wcykgPT4ge1xyXG4gICAgbGV0IF9wcm9wcyA9IHByb3BzLnNwbGl0KCcuJylcclxuICAgIGNvbnNvbGUubG9nKF9wcm9wcylcclxuICAgIGxldCB2YWwgPSB7fVxyXG4gICAgbGV0IG8gPSB0YXJnZXRbX3Byb3BzWzBdXVxyXG4gICAgZm9yIChsZXQgaSA9IDE7IGkgPCBfcHJvcHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgbyA9IG9bX3Byb3BzW2ldXVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIG9cclxuICB9XHJcbiAgXHJcbiAgZXhwb3J0IHt0cmF2ZXJzZVRvUHJvcH1cclxuIFxyXG4gICIsIiAgLy9vbmx5IHRoaXMgZ3V5IHNob3VsZCB0b3VjaCB0aGUgRE9NLCBraWRkaW5nIG5vdFxyXG4gIGV4cG9ydCBjb25zdCByZW5kZXIgPSBmdW5jdGlvbih0ZW1wbGF0ZSwgaWQpIHtcclxuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKS5pbm5lckhUTUwgPSB0ZW1wbGF0ZS5hcHBseSh0aGlzKVxyXG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZVByb3BzJylcclxuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmVQcm9wcycpXHJcbiAgICB9LCAzMDAwKVxyXG4gIH0iLCJcclxuaW1wb3J0IHsgRGVwIH0gZnJvbSAnLi9kZXAuanMnXHJcbmltcG9ydCB7IFdhdGNoZXIgfSBmcm9tICcuL3dhdGNoZXIuanMnXHJcbmltcG9ydCB7IGJpbmRQcm9wVG9UZW1wbGF0ZSB9IGZyb20gJy4vYmluZFByb3AuanMnXHJcbmltcG9ydCB7IHJlbmRlciB9IGZyb20gJy4uL3JlbmRlci5qcydcclxuXHJcbmNvbnN0IGluaXREYXRhID0gZnVuY3Rpb24gKG9iaiwgcmVhY3RpdmUsIG5lc3RlZCkge1xyXG4gIGlmICh0eXBlb2Ygb2JqICE9PSAnb2JqZWN0Jykge1xyXG4gICAgcmV0dXJuIG9ialxyXG4gIH1cclxuICBsZXQgd3JhcHBlciA9IHt9XHJcblxyXG4gIGZvciAobGV0IHByb3AgaW4gb2JqKSB7XHJcbiAgICBsZXQgdmFsID0gb2JqW3Byb3BdXHJcbiAgICBpZiAodHlwZW9mIG9ialtwcm9wXSA9PT0gXCJvYmplY3RcIikge1xyXG4gICAgICB2YWwgPSBpbml0RGF0YShvYmpbcHJvcF0sIHJlYWN0aXZlLCB0cnVlKVxyXG4gICAgfVxyXG4gICAgbGV0IGRlcCA9IG5ldyBEZXAocHJvcClcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuZXN0ZWQgPyB3cmFwcGVyIDogcmVhY3RpdmUsIHByb3AsIHtcclxuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKERlcC50YXJnZXQpIHtcclxuICAgICAgICAgIGRlcC5kZXBlbmQoRGVwLnRhcmdldClcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHZhbFxyXG4gICAgICB9LFxyXG4gICAgICBzZXQ6IGZ1bmN0aW9uIChuZXdWYWwpIHtcclxuICAgICAgICB2YWwgPSBpbml0RGF0YShuZXdWYWwsIHJlYWN0aXZlKVxyXG4gICAgICAgIGRlcC5ub3RpZnkoKVxyXG4gICAgICB9XHJcbiAgICB9KVxyXG4gIH1cclxuICByZXR1cm4gbmVzdGVkID8gd3JhcHBlciA6IHJlYWN0aXZlXHJcbn1cclxuXHJcbmNvbnN0IG1ha2VSZWFjdGl2ZSA9IGZ1bmN0aW9uICh2bSwgcHJvcFZhbHVlSGFzaCwgcGFyZW50KSB7XHJcbiAgbGV0IHJlYWN0aXZlID0ge31cclxuICByZWFjdGl2ZS5yZW5kZXIgPSByZW5kZXJcclxuICByZWFjdGl2ZS5iaW5kUHJvcFRvVGVtcGxhdGUgPSBiaW5kUHJvcFRvVGVtcGxhdGVcclxuICBjb25zdCBjb21wdXRlZCA9IHZtLmNvbXB1dGVkXHJcbiAgY29uc3QgdGVtcGxhdGVzID0gdm0udGVtcGxhdGVzXHJcbiAgY29uc3QgcHJvcHMgPSB2bS5wcm9wcyB8fCBbXVxyXG4gIGNvbnN0IGNvbXBvbmVudHMgPSB2bS5jb21wb25lbnRzIHx8IFtdXHJcbiAgY29uc3QgZGF0YSA9ICh2bS5kYXRhICYmIHZtLmRhdGEoKSkgfHwge31cclxuXHJcbiAgaW5pdERhdGEoZGF0YSwgcmVhY3RpdmUpXHJcblxyXG4gIGluaXRDb21wdXRlZChyZWFjdGl2ZSwgY29tcHV0ZWQpXHJcblxyXG4gIGluaXRQcm9wcyhyZWFjdGl2ZSwgcHJvcHMsIHByb3BWYWx1ZUhhc2gsIHBhcmVudClcclxuXHJcbiAgaW5pdFRlbXBsYXRlcyhyZWFjdGl2ZSwgdGVtcGxhdGVzKVxyXG5cclxuICBpbml0Q29tcG9uZW50cyhyZWFjdGl2ZSwgY29tcG9uZW50cylcclxuXHJcbiAgcmV0dXJuIHJlYWN0aXZlXHJcbn1cclxuXHJcbmZ1bmN0aW9uIGluaXRDb21wdXRlZChyZWFjdGl2ZSwgY29tcHV0ZWQpIHtcclxuICBsZXQgY29tcHV0ZWRXYXRjaGVycyA9IHt9XHJcbiAgbGV0IGNvbXB1dGVkRGVwcyA9IHt9XHJcblxyXG4gIC8vIGZvciAobGV0IHByb3AgaW4gY29tcHV0ZWQpIHtcclxuICAvLyAgIGNvbXB1dGVkV2F0Y2hlcnNbcHJvcF0gPSBuZXcgV2F0Y2hlcignQ29tcHV0ZWQgd2F0Y2hlciBwcm9wOiAnICsgcHJvcCwgZnVuY3Rpb24gKCkge1xyXG4gIC8vICAgICBjb21wdXRlZERlcHNbcHJvcF0ubm90aWZ5KClcclxuICAvLyAgIH0sIG51bGwpXHJcbiAgLy8gfVxyXG5cclxuICAvL1JlYWN0aXZlIGNvbXB1dGVkIHByb3BzXHJcbiAgZm9yIChsZXQgcHJvcCBpbiBjb21wdXRlZCkge1xyXG4gICAgbGV0IGNhY2hlZFZhbHVlXHJcbiAgICAvL0NvbXB1dGVkIHByb3BlcnRpZXMgZ2V0cyB0aGVpciBvd24gd2F0Y2hlcnMhIFxyXG4gICAgY29tcHV0ZWRXYXRjaGVyc1twcm9wXSA9IG5ldyBXYXRjaGVyKCdDb21wdXRlZCB3YXRjaGVyIHByb3A6ICcgKyBwcm9wLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIGNhY2hlZFZhbHVlID0gY29tcHV0ZWRbcHJvcF0uYXBwbHkocmVhY3RpdmUpXHJcbiAgICAgIGNvbXB1dGVkRGVwc1twcm9wXS5ub3RpZnkoKVxyXG4gICAgfSwgbnVsbClcclxuXHJcbiAgICBEZXAudGFyZ2V0ID0gY29tcHV0ZWRXYXRjaGVyc1twcm9wXVxyXG4gICAgY2FjaGVkVmFsdWUgPSBjb21wdXRlZFtwcm9wXS5hcHBseShyZWFjdGl2ZSlcclxuICAgIERlcC50YXJnZXQgPSBudWxsXHJcblxyXG4gICAgY29tcHV0ZWREZXBzW3Byb3BdID0gbmV3IERlcChwcm9wKVxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHJlYWN0aXZlLCBwcm9wLCB7XHJcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmIChEZXAudGFyZ2V0KSB7XHJcbiAgICAgICAgICBjb21wdXRlZERlcHNbcHJvcF0uZGVwZW5kKERlcC50YXJnZXQpXHJcbiAgICAgICAgICBEZXAudGFyZ2V0ID0gbnVsbFxyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBEZXAudGFyZ2V0ID0gY29tcHV0ZWRXYXRjaGVyc1twcm9wXVxyXG4gICAgICAgIC8vIGxldCB2YWwgPSBjb21wdXRlZFtwcm9wXS5hcHBseSh0aGlzKVxyXG4gICAgICAgIC8vIERlcC50YXJnZXQgPSBudWxsXHJcbiAgICAgICAgcmV0dXJuIGNhY2hlZFZhbHVlXHJcbiAgICAgIH1cclxuICAgIH0pXHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBpbml0UHJvcHMocmVhY3RpdmUsIHByb3BzLCBwcm9wVmFsdWVIYXNoLCBwYXJlbnQpIHtcclxuICBmb3IgKGxldCBwcm9wIG9mIHByb3BzKSB7XHJcbiAgICBsZXQgZGVwID0gbmV3IERlcChwcm9wKVxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHJlYWN0aXZlLCBwcm9wLCB7XHJcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmIChEZXAudGFyZ2V0KSB7XHJcbiAgICAgICAgICBkZXAuZGVwZW5kKERlcC50YXJnZXQpXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBwYXJlbnRbcHJvcFZhbHVlSGFzaFtwcm9wXV1cclxuICAgICAgfVxyXG4gICAgfSlcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGluaXRUZW1wbGF0ZXMocmVhY3RpdmUsIHRlbXBsYXRlcykge1xyXG4gIGZvciAobGV0IHRlbXBsYXRlIG9mIHRlbXBsYXRlcykge1xyXG4gICAgcmVhY3RpdmUuYmluZFByb3BUb1RlbXBsYXRlKHRlbXBsYXRlLmh0bWwsIHRlbXBsYXRlLmlkLCB0ZW1wbGF0ZS5wcm9wKVxyXG4gICAgcmVhY3RpdmUucmVuZGVyKHRlbXBsYXRlLmh0bWwsIHRlbXBsYXRlLmlkKVxyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gaW5pdENvbXBvbmVudHMocmVhY3RpdmUsIGNvbXBvbmVudHMpIHtcclxuICBmb3IgKGxldCBjb21wb25lbnQgb2YgY29tcG9uZW50cykge1xyXG4gICAgbGV0IHRlbXBsYXRlID0gY29tcG9uZW50LnRlbXBsYXRlKClcclxuICAgIGxldCBuYW1lID0gY29tcG9uZW50Lm5hbWVcclxuICAgIGxldCB2YWx1ZSA9IGNvbXBvbmVudC52YWx1ZVxyXG4gICAgbGV0IGNoaWxkVGVtcGxhdGVzID0gdmFsdWUudGVtcGxhdGVzXHJcbiAgICBpZiAodGVtcGxhdGUuaW5kZXhPZihuYW1lKSA9PT0gLTEpIHtcclxuICAgICAgY29uc29sZS53YXJuKGAke25hbWV9IG5vdCBkZWZpbmVkIGluIHRoZSB0ZW1wbGF0ZWApXHJcbiAgICAgIGJyZWFrXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBsZXQgYXR0cnMgPSB0ZW1wbGF0ZS5zcGxpdCgnPC8nICsgbmFtZSArICc+JylbMF0uc3BsaXQoJ2RhdGEtJylcclxuICAgICAgbGV0IHByb3BWYWx1ZUhhc2ggPSB7fVxyXG4gICAgICBmb3IgKGxldCBhdHRyIG9mIGF0dHJzKSB7XHJcbiAgICAgICAgaWYgKGF0dHIuaW5kZXhPZignPScpICE9PSAtMSkge1xyXG4gICAgICAgICAgbGV0IGt2cCA9IGF0dHIuc3BsaXQoJz0nKVxyXG4gICAgICAgICAgcHJvcFZhbHVlSGFzaFtrdnBbMF1dID0ga3ZwWzFdLnNwbGl0KCdcIicpWzFdXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGNvbnNvbGUubG9nKCdwcm9wVmFsdWVIYXNoOicgKyBKU09OLnN0cmluZ2lmeShwcm9wVmFsdWVIYXNoKSlcclxuICAgICAgbWFrZVJlYWN0aXZlKHZhbHVlLCBwcm9wVmFsdWVIYXNoLCByZWFjdGl2ZSlcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCB7IG1ha2VSZWFjdGl2ZSB9XHJcblxyXG4iLCJcclxubGV0IHRlbXBsYXRlRm9yQSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgcmV0dXJuIGA8cD5IZWxsbywgSSBhbSBhIDxpPmRhdGE8L2k+IHByb3AuIFlvdSBjYW4gY2FsbCBtZSA8c3Ryb25nPkE8L3N0cm9uZz46ICR7dGhpcy5hfTwvcD5gXHJcbiAgfVxyXG4gIFxyXG4gIGxldCB0ZW1wbGF0ZUZvckIgPSBmdW5jdGlvbigpIHtcclxuICAgIHJldHVybiBgPHA+SGVsbG8sIEkgYW0gYSA8aT5jb21wdXRlZDwvaT4gcHJvcC4gWW91IGNhbiBjYWxsIG1lIDxzdHJvbmc+Qjwvc3Ryb25nPiAoQSAqIDEwKTogJHt0aGlzLmJ9PC9wPmBcclxuICB9XHJcbiAgXHJcbiAgbGV0IHRlbXBsYXRlRm9yQyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgcmV0dXJuIGA8cD5IZWxsbywgSSBhbSBhIDxpPmRhdGE8L2k+IHByb3AuIFlvdSBjYW4gY2FsbCBtZSA8c3Ryb25nPkM8L3N0cm9uZz46ICR7dGhpcy5jfTwvcD5gXHJcbiAgfVxyXG4gIFxyXG4gIGxldCB0ZW1wbGF0ZUZvckQgPSBmdW5jdGlvbigpIHtcclxuICAgIHJldHVybiBgPHA+SGVsbG8sIEkgYW0gYSA8aT5jb21wdXRlZDwvaT4gcHJvcC4gWW91IGNhbiBjYWxsIG1lIDxzdHJvbmc+RDwvc3Ryb25nPiAoQiArIDExKTogJHt0aGlzLmR9PC9wPmBcclxuICB9XHJcbiAgXHJcbiAgXHJcbiAgbGV0IHRlbXBsYXRlRm9yRiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgcmV0dXJuIGA8cD5IZWxsbywgSSBhbSBhIDxpPm5lc3RlZCBkYXRhPC9pPiBwcm9wLiBZb3UgY2FuIGNhbGwgbWUgPHN0cm9uZz5GPC9zdHJvbmc+KExlbmd0aCk6ICR7dGhpcy5lLmZ9PC9wPmBcclxuICB9XHJcbiAgXHJcbiAgbGV0IHRlbXBsYXRlRm9yRyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgcmV0dXJuIGA8cD5IZWxsbywgSSBhbSBhIDxpPm5lc3RlZCBkYXRhPC9pPiBwcm9wLiBZb3UgY2FuIGNhbGwgbWUgPHN0cm9uZz5HPC9zdHJvbmc+KFdpZHRoKTogJHt0aGlzLmUuZ308L3A+YFxyXG4gIH1cclxuICBcclxuICBcclxuICBsZXQgdGVtcGxhdGVGb3JIID0gZnVuY3Rpb24oKSB7XHJcbiAgICByZXR1cm4gYDxwPkhlbGxvLCBJIGFtIGEgPGk+bmVzdGVkIGNvbXB1dGVkPC9pPiBwcm9wLiBZb3UgY2FuIGNhbGwgbWUgPHN0cm9uZz5IPC9zdHJvbmc+KEFyZWEpOiAke3RoaXMubmVzdGVkQ29tcHV0ZWR9PC9wPmBcclxuICB9XHJcbiAgXHJcbiAgbGV0IHRlbXBsYXRlQUZvckNvbXBvbmVudEIgPSBmdW5jdGlvbigpIHtcclxuICAgIHJldHVybiBgPHA+SSdtIGEgY2hpbGQgY29tcG9uZW50IEkgaGF2ZSBpbmhlcml0ZWQgbXkgcGFyZW50J3MgcHJvcGVydHkgYTogJHt0aGlzLmExfTwvcD5gXHJcbiAgfVxyXG4gIFxyXG4gIGxldCB0ZW1wbGF0ZUJGb3JDb21wb25lbnRCID0gZnVuY3Rpb24oKSB7XHJcbiAgICByZXR1cm4gYDxwPkknbSBhIGNoaWxkIGNvbXBvbmVudC4gVGhpcyBpcyBteSBwcm9wZXJ0eSBCMTogJHt0aGlzLmIxfTwvcD5gXHJcbiAgfVxyXG4gIFxyXG4gIGxldCB0ZW1wbGF0ZUZvckNoaWxkQ29tcG9uZW50UGxhY2Vob2xkZXIgPSBmdW5jdGlvbigpIHtcclxuICAgIHJldHVybiBgPG15LWNoaWxkLWNvbXBvbmVudCBkYXRhLWExPVwiYVwiPjwvbXktY2hpbGQtY29tcG9uZW50PmBcclxuICB9XHJcblxyXG4gIGV4cG9ydCBkZWZhdWx0IHtcclxuICAgICAgdGVtcGxhdGVGb3JBLFxyXG4gICAgICB0ZW1wbGF0ZUZvckIsXHJcbiAgICAgIHRlbXBsYXRlRm9yQyxcclxuICAgICAgdGVtcGxhdGVGb3JELFxyXG4gICAgICB0ZW1wbGF0ZUZvckYsXHJcbiAgICAgIHRlbXBsYXRlRm9yRyxcclxuICAgICAgdGVtcGxhdGVGb3JILFxyXG4gICAgICB0ZW1wbGF0ZUFGb3JDb21wb25lbnRCLFxyXG4gICAgICB0ZW1wbGF0ZUJGb3JDb21wb25lbnRCLFxyXG4gICAgICB0ZW1wbGF0ZUZvckNoaWxkQ29tcG9uZW50UGxhY2Vob2xkZXJcclxuICB9IiwiLy9Db21wb25lbnQgRGVmaW5pdGlvbnNcclxuaW1wb3J0IHRlbXAgZnJvbSAnLi90ZW1wbGF0ZXMuanMnXHJcbmNvbnN0IGNoaWxkQ29tcG9uZW50ID0ge1xyXG4gICAgbmFtZTogJ2NoaWxkQ29tcG9uZW50JyxcclxuICAgIHByb3BzOiBbJ2ExJ10sXHJcbiAgICBkYXRhKCkge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGIxOiAxMFxyXG4gICAgICB9XHJcbiAgICB9LFxyXG4gICAgdGVtcGxhdGVzOiBbe1xyXG4gICAgICAgIGh0bWw6IHRlbXAudGVtcGxhdGVBRm9yQ29tcG9uZW50QixcclxuICAgICAgICBpZDogXCJjaGlsZF9hXCIsXHJcbiAgICAgICAgcHJvcDogXCJhMVwiXHJcbiAgICAgIH0sXHJcbiAgICAgIHtcclxuICAgICAgICBodG1sOiB0ZW1wLnRlbXBsYXRlQkZvckNvbXBvbmVudEIsXHJcbiAgICAgICAgaWQ6IFwiY2hpbGRfYlwiLFxyXG4gICAgICAgIHByb3A6IFwiYjFcIlxyXG4gICAgICB9XHJcbiAgICBdXHJcbiAgfVxyXG4gIFxyXG4gIGNvbnN0IGNvbXBvbmVudE9uZSA9IHtcclxuICAgIG5hbWU6ICdjb21wb25lbnRPbmUnLFxyXG4gICAgZGF0YSgpIHtcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBhOiA1LFxyXG4gICAgICAgIGM6ICdIZWxsbyB0aGVyZSEhJyxcclxuICAgICAgICBlOiB7XHJcbiAgICAgICAgICBmOiA1LFxyXG4gICAgICAgICAgZzogNlxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSxcclxuICAgIGNvbXB1dGVkOiB7XHJcbiAgICAgIGI6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmEgKiAxMFxyXG4gICAgICB9LFxyXG4gICAgICBkOiBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5iICsgMTFcclxuICAgICAgfSxcclxuICAgICAgbmVzdGVkQ29tcHV0ZWQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmIChpc05hTih0aGlzLmUuZikgfHwgaXNOYU4odGhpcy5lLmcpKSB7XHJcbiAgICAgICAgICByZXR1cm4gMFxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5lLmYgKiB0aGlzLmUuZ1xyXG4gICAgICB9XHJcbiAgICB9LFxyXG4gICAgZWw6ICdhcHBSb290JyxcclxuICAgIHRlbXBsYXRlczogW3tcclxuICAgICAgICBodG1sOiB0ZW1wLnRlbXBsYXRlRm9yQSxcclxuICAgICAgICBpZDogXCJhXCIsXHJcbiAgICAgICAgcHJvcDogXCJhXCJcclxuICAgICAgfSxcclxuICAgICAge1xyXG4gICAgICAgIGh0bWw6IHRlbXAudGVtcGxhdGVGb3JCLFxyXG4gICAgICAgIGlkOiBcImJcIixcclxuICAgICAgICBwcm9wOiBcImJcIlxyXG4gICAgICB9LFxyXG4gICAgICB7XHJcbiAgICAgICAgaHRtbDogdGVtcC50ZW1wbGF0ZUZvckMsXHJcbiAgICAgICAgaWQ6IFwiY1wiLFxyXG4gICAgICAgIHByb3A6IFwiY1wiXHJcbiAgICAgIH0sXHJcbiAgICAgIHtcclxuICAgICAgICBodG1sOiB0ZW1wLnRlbXBsYXRlRm9yRCxcclxuICAgICAgICBpZDogXCJkXCIsXHJcbiAgICAgICAgcHJvcDogXCJkXCJcclxuICAgICAgfSxcclxuICAgICAge1xyXG4gICAgICAgIGh0bWw6IHRlbXAudGVtcGxhdGVGb3JGLFxyXG4gICAgICAgIGlkOiBcImZcIixcclxuICAgICAgICBwcm9wOiBcImUuZlwiXHJcbiAgICAgIH0sXHJcbiAgICAgIHtcclxuICAgICAgICBodG1sOiB0ZW1wLnRlbXBsYXRlRm9yRyxcclxuICAgICAgICBpZDogXCJnXCIsXHJcbiAgICAgICAgcHJvcDogXCJlLmdcIlxyXG4gICAgICB9LFxyXG4gICAgICB7XHJcbiAgICAgICAgaHRtbDogdGVtcC50ZW1wbGF0ZUZvckgsXHJcbiAgICAgICAgaWQ6IFwiaFwiLFxyXG4gICAgICAgIHByb3A6IFwibmVzdGVkQ29tcHV0ZWRcIlxyXG4gICAgICB9XHJcbiAgICBdLFxyXG4gICAgY29tcG9uZW50czogW3tcclxuICAgICAgbmFtZTogJ215LWNoaWxkLWNvbXBvbmVudCcsXHJcbiAgICAgIHZhbHVlOiBjaGlsZENvbXBvbmVudCxcclxuICAgICAgdGVtcGxhdGU6IHRlbXAudGVtcGxhdGVGb3JDaGlsZENvbXBvbmVudFBsYWNlaG9sZGVyXHJcbiAgICB9XVxyXG4gIH1cclxuXHJcbiAgZXhwb3J0IHtjaGlsZENvbXBvbmVudCwgY29tcG9uZW50T25lfSIsImltcG9ydCB7bWFrZVJlYWN0aXZlfSBmcm9tICcuL3JlYWN0aXZlL29ic2VydmVyLmpzJ1xyXG5pbXBvcnQge2NvbXBvbmVudE9uZX0gZnJvbSAnLi9jb21wb25lbnRzLmpzJ1xyXG4vL0V2ZW50IGhhbmRsZXIgZm9yIGlucHV0IGNoYW5nZXNcclxuZnVuY3Rpb24gc2V0VmFsRm9yQShlKSB7XHJcbiAgICBsZXQgdmFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2lucHV0QScpLnZhbHVlO1xyXG4gICAgaWYgKCFpc05hTih2YWwpKSB7XHJcbiAgICAgIG15Rmlyc3RSZWFjdGl2ZUNvbXBvbmVudC5hID0gdmFsXHJcbiAgICB9XHJcbiAgfVxyXG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbnB1dEEnKS5vbmNoYW5nZSA9IHNldFZhbEZvckFcclxuICBcclxuICBmdW5jdGlvbiBzZXRWYWxGb3JDKGUpIHtcclxuICAgIGxldCB2YWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW5wdXRDJykudmFsdWU7XHJcbiAgICBteUZpcnN0UmVhY3RpdmVDb21wb25lbnQuYyA9IHZhbFxyXG4gIH1cclxuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW5wdXRDJykub25jaGFuZ2UgPSBzZXRWYWxGb3JDXHJcbiAgXHJcbiAgZnVuY3Rpb24gc2V0VmFsRm9yRihlKSB7XHJcbiAgICBsZXQgdmFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2lucHV0RicpLnZhbHVlO1xyXG4gICAgbXlGaXJzdFJlYWN0aXZlQ29tcG9uZW50LmUuZiA9IHZhbFxyXG4gIH1cclxuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW5wdXRGJykub25jaGFuZ2UgPSBzZXRWYWxGb3JGXHJcbiAgXHJcbiAgZnVuY3Rpb24gc2V0VmFsRm9yRyhlKSB7XHJcbiAgICBsZXQgdmFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2lucHV0RycpLnZhbHVlO1xyXG4gICAgbXlGaXJzdFJlYWN0aXZlQ29tcG9uZW50LmUuZyA9IHZhbFxyXG4gIH1cclxuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2lucHV0RycpLm9uY2hhbmdlID0gc2V0VmFsRm9yR1xyXG5cclxubGV0IG15Rmlyc3RSZWFjdGl2ZUNvbXBvbmVudCA9IG1ha2VSZWFjdGl2ZShjb21wb25lbnRPbmUpXHJcbmNvbnNvbGUubG9nKG15Rmlyc3RSZWFjdGl2ZUNvbXBvbmVudClcclxuc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgbXlGaXJzdFJlYWN0aXZlQ29tcG9uZW50LmMgPSBcImhlbGxvIENoaWNhZ28hIVwiXHJcbn0sIDIwMDApXHJcblxyXG4iXSwic291cmNlUm9vdCI6IiJ9